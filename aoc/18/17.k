#!../../k
x:0:"i/17"
x:2#''`I$(".."\2_)''{x@>x}'", "\'x
x:x-\:O:-1+&/&/x
n:2+|/|/x
I:{x+!1+y-x}/
a:(n#".").[;;:;"#"]/I''x
e:{(</~^"#~"?a[x+!2]@'(z,0)+)(z+)/y}
f:{i:e[x;y;]'-1 1;a[x;I i]:"|";x F'i@&"."=a[1+x]i;$[&/|/'"#~"=/:a[1+x]i;[a[x;I i]:"~";o[x-1]y];]}
F:{X:(|/".|"=a[;y]1+)(1+)/x;a[I x,X;y]:"|";$[~^a[1+X]y;f[X]y;]}
F[0;500-O 1]
+//"|~"=\:1_-1_a
+// "~"=  1_-1_a
