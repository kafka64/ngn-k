#!/usr/bin/env k
abs:{x|-x}
d:+/abs@-/(s;b):|'2 2#`I$+{(" "\x^",:xy=")2 3 8 9}'0:"i/15"

/part1
r:2000000 /row
e:d-abs r-*s
w:{|\(x[0]| :':x 1;x 1)}/w@\:<*w:s[1]+/:(-e;1+e)
(+/0|-/|w) - #?b[1;&r=b 0],s[1;&r=s 0]

/part2
{$[|/&/~d</:+/'abs s-/:,/,/:\:/+x-!2;0
   -2<&/-/x;4000000/|*x
   |/o'+',/,/:\:/,''2':'+(*x;-2!+/x;*|x)]}2#'0 4000001
