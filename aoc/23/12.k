#!../../k
f:{[x;y;i;j] /count arrangements for i#x and j#y
 :t[i;j]: :[-1<v:t[i;j];v
            i<-1+/1+j#y;0
            ~j;~+/"#"=i#x
            +/(o[x;y;i-1;j]*|/".?"=x i-1
               o[x;y;0|i-k;j-1]*&/|/((-k)#i#x)=/:"#.?"2,,~!k:1+*|j#y)]}

g:+/{x[0]::".",*x;t::(1+n:#'x)#-1;f . x,n}'

x:@[;1;.:]'" "\'0:"i/12"
g@x                     /1
g@{("?"/;,/)@'5#','x}'x /2
