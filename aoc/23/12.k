#!../../k
f:{[i;j] :T[i;j]: :[-1<v:T[i;j];v
                    i<-1+/1+j#Y;0
                    +/(o[i-1;j]*|/".?"=X i-1
                       o[0|i-k;j-1]*&/|/#[-k;i#X]=/:"#.?"2,,~!k:1+Y j-1)]}

g:{X::x:".",x
   Y::y
   T::(1+#x;1+#y)#-1
   T[;0]:1,~|\"#"=x
   f[#x;#y]}

x:@[;1;.:]'" "\'0:"i/12"
+/g.'x                     /1
+/g.'{("?"/;,/)@'5#','x}'x /2

\cat o/12
