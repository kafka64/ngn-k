abs:{x|-x}
sgn:{(x>0)-x<0}
gcd:*|(*:)(|!\)/,
lcm:{x*(-gcd[x]y)!y}
prm:{(x-1){,/'((,(#*x)#`c$#x),x)(~i=\:i)*i+i<\:i:!1+#x}/+0x00}
D:(|-1 1*)\!2
I:{T/(0;x;0;y;!0)}
E:{99=100!@/x 1 0}
Am:{@[$[y<#x;x;x,(0|y+1-#x)#0];y;:;z]}
Tf:(+/;*/;</;=/)
T:{[i;a;r;u;v]
 (p;q;R):(a;::;r+a@)[10!-100 -1000 -10000!'a i]@'i+1 2 3
 c:100!a i
 $[c=3;(a;u):(Am[a;p;*u];1_u)
   c=4;v,:a p
   |/c=5 6;i:$[2!c+~a p;a q;3+i]
   -1<j:1 2 7 8?c;a:Am[a;R;Tf[j]a p,q]
   c=9;r+:a p]
 (i+0|0 4 4 2 2 0 0 4 4 2 c;a;r;u;v)}.
