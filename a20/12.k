#!../k
a:{("ENWSFL.R"?*x;. 1_x)}'0:"i/12"
R:|1 -1*;D:R\!2;M:{+/x|-x}
M@*0{(p;d):x;(c;v):y;$[c<4;(p+v*D c;d);c=4;(p+v*D d;d);(p;4!d+(6-c)*-90!v)]}/a
M@*(0;-1 10){(p;w):x;(c;v):y;$[c<4;(p;w+v*D c);c=4;(p+v*w;w);(p;(4!(6-c)*-90!v)R/w)]}/a
