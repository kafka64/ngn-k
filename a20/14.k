#!../k
a:0:"i/14"
i:&b:"a"=a@'1
m:`i$("01X"?-36#+a i)@\:&-1+1_-':i,#a /masks
(M;v):.'" "/'+4 3_'/:"]"\'a@&~b /mem addresses and values
p:&((2*)\1)k:+/X:2=m
O:`i${!x#2}'!1+|/k /odometers
l:{|(~=':x i)@<i:<x:|x} /last occurrences
+/l[M]*2/(m*~X)+X*(36#2)\v /part1
+/v[p]*l@2/t@\:&|/t:(@[;p]'(~X)&m|(36#2)\M)+,'/(`i$&'+X){+@[36#0i;x;:;]'+y}'O k /part2
