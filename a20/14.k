#!../k
a:0:"i/14"
i:&b:"a"=a@'1
m:("01X"?-36#+a i)@\:&-1+1_-':i,#a /masks
(M;n):.'" "/'+4 3_'/:"]"\'a@&~b /mems
p:&((2*)\1)k:+/X:2=m
O:{!x#2}'!1+|/k /odometers
l:{|(~=':x i)@<i:<x:|x} /last occurrences
+/l[M]*2/(m*~X)+X*(36#2)\n /part1
+/n[p]*l@2/t:t@\:&|/t:(@[;p]'(~X)&m|(36#2)\M)++,/(+X){@[x;&x;:;]'+y}'O k /part2
