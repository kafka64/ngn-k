#!../k
x:0N;(t;N):.'0:"i/13";n:N^0N
*/(r;n)@\:*<r:n!'n-t

a:n!'n-&~^N
I:{$[y=1;:1;];v+y*0>v:*|{$[2>*x;:x;];(a;b;u;v):x;(b;b!a;v-u*(-b)!a;u)}/(x;y;0;1)} /modular inverse
!/(*/n;0){(P;s):x;(ni;ai):y;P,s+ai*I[p;ni]*p:(-ni)!P}/n,'a /crt
