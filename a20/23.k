#!../k
n:`i$#a:`i$-1+.'*0:"i/23"
l:@[n#0i;a;:;(1_a),*a]
f:{u:2(l@)\l x
   l[x]:l[*|u]
   d:(|/u=)(n!-1i+)/n!x-1i
   l[*|u]:l[d]
   l[d]:*u
   l[x]}
100 f/*a;.,/$1i+1_(l@)\0i /part1

n:1000000i
a:@[`i$!n;!#a;:;a]
l:@[n#0i;a;:;(1_a),*a]
10000000 f/*a;*/1+(*l;l@*l) /part2
