#include"a.h" // ngn/k, (c) 2019-2023 ngn, GNU AGPLv3 - https://codeberg.org/ngn/k/raw/branch/master/LICENSE

S A2 f;
A1(ser,x(f(x,oC)))
S A ff(Lv,Ay)_(cts(y,(V*)&v,8))
S A2(fA,/*01*/Nn=xn;y=ff(n,y);i(n|!n,y=f(xa,y))y)
S A2(f,/*01*/y=apc(y,xt);
 X(
  RmMA(fA(x,y))
  RS(y=ff(xn,y);i(xn,y=f(as(xi),y))y)
  Rs(Lv=xv;Qs=qs(&v);In=SL(s)+1;y=apc(y,n);cts(y,s,n))
  R6(ti,tc,tu,tv,tw,tx,ff(x,y))
  R4(to,tp,tq,tr,Q(xw==4);fA(x,apc(y,(xtr?xE:xv)<<3|xk)))
  R_(In=8*xtT;cts(y,xV-n,n+xn*xW)))0)

#define h(n) ({P(p-s<n,ed0());C*r=s;s+=n;r;})
#define h1 (*(C*)h(1))
#define h8 (*(L*)h(8))
S A0 g;S C*s,*p;
A1(des,XC(s=xV;p=s+xn;x(g()))ed1(x))
S A0(gA,Ln=h8;P(!IN(n,1ll<<45),ed0())Ax=aA(n);i(n|!n,P(!(xa=g()),mrn(i,xA);AZ(x);x(0)))x)
S A0(g,Ct=h1;P(!IN(t,tn),ed0())
 SW(t,
  R(tA,gA())
  R2(tm,tM,Ax=N(gA());P(!xtA||xn-2||_t(xx)>tM||_t(xy)>tM||_N(xx)-_N(xy),ed1(x))AT(t,mut(x)))
  R(tS,Ln=h8;P(!IN(n,1ll<<45),ed0())Ax=oS;i(n,xq(Nx(g())))x)
  R(ts,Nn=h1;sym(h(n)))
  R6(ti,tc,tu,tv,tw,tx,h8)
  R4(to,tp,tq,tr,Cc=h1;Ax=N(gA());AT(t,AK(c&7,t==tr?AW(c>>3,x):AV(c>>3,x))))
  R_(Ln=t<tm?h8:1;P(!IN(n,1ll<<45),ed0())aV(t,n,h(n*TW[t]))))0)
