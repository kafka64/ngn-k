\l 0.k
M:1500000 /max perimeter
c:&1+M    /counters
{x@:<x;L:+/x;$[L>M;:0;];c[L*!1+(-L)!M]+:1
 o'+/((  1 2 2;- 1 2 2;1 2 2)
      (- 2 1 2;  2 1 2;2 1 2)
      (  2 2 3;  2 2 3;2 2 3))*x;}3 4 5
c[0]:0
+/1=c
/161667
