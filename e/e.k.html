<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>pe 100 in ngn/k</title>
<meta name="Generator" content="Vim/8.0">
<meta name="plugin-version" content="vim7.4_v2">
<meta name="syntax" content="k">
<meta name="settings" content="use_css,no_foldcolumn,expand_tabs,prevent_copy=">
<meta name="colorscheme" content="n">
<style type="text/css">
<!--
pre { font-family: monospace; color: #ffffff; background-color: #000000; }
body { font-family: monospace; color: #ffffff; background-color: #000000; }
* { font-size: 1em; }
.Constant { color: #ff40ff; font-weight: bold; }
.Type { color: #00ff00; font-weight: bold; }
.Comment { color: #808080; font-weight: bold; }
.Delimiter { color: #8080ff; }
.Special { color: #ff6060; font-weight: bold; }
.Identifier { color: #00ffff; font-weight: bold; }
.Statement { color: #ffff00; font-weight: bold; }
-->
</style>

<script type='text/javascript'>
<!--

-->
</script>
</head>
<body>
<pre id='vimCodeElement'>
<span class="Comment">/number theory</span>
primes<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">&lt;</span><span class="Constant">10</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Special">o</span><span class="Constant"> 10</span><span class="Delimiter">;</span><span class="Delimiter">]</span>
        r<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">&amp;@</span><span class="Delimiter">[</span><span class="Delimiter">(</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Constant">0x010000010001010001010001000001</span><span class="Delimiter">;</span><span class="Identifier">!</span><span class="Constant">3</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">0x01</span><span class="Delimiter">]</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">@</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">y</span><span class="Type">*</span><span class="Special">y</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">!</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">2</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">-</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">-</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Type">!</span><span class="Constant">-1</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">0x00</span><span class="Delimiter">]</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">7</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">!</span><span class="Constant">0</span><span class="Type">|</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">-5</span><span class="Type">+</span><span class="Identifier">_%</span><span class="Special">x</span>
        r<span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Statement">:</span><span class="Constant">2</span><span class="Special">;</span>r<span class="Special">}</span>
isprime<span class="Statement">:</span><span class="Special">{</span>p<span class="Statement">:</span><span class="Constant">2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">&lt;</span><span class="Constant">62</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Identifier">~^</span>p<span class="Type">?</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Identifier">~&amp;</span><span class="Statement">/</span>p<span class="Type">!</span><span class="Statement">'</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Constant">0</span><span class="Delimiter">]</span>
         b<span class="Statement">:</span><span class="Identifier">|</span><span class="Constant">2</span><span class="Statement">\</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">1</span><span class="Special">;</span>s<span class="Statement">:</span>b<span class="Type">?</span><span class="Constant">1</span><span class="Special">;</span>d<span class="Statement">:</span>s<span class="Type">_</span>b<span class="Special">;</span>sqr<span class="Statement">:</span><span class="Special">{</span><span class="Special">x</span><span class="Type">!</span><span class="Special">y</span><span class="Type">*</span><span class="Special">y</span><span class="Special">}</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">;</span>ad<span class="Statement">:</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">!</span><span class="Identifier">*</span><span class="Delimiter">)</span><span class="Statement">/</span><span class="Delimiter">((</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">#</span>d<span class="Delimiter">)</span>sqr<span class="Statement">\</span><span class="Constant">2 3 61</span><span class="Delimiter">)</span><span class="Type">@</span><span class="Identifier">&amp;</span>d<span class="Special">;</span>a2sd<span class="Statement">:</span><span class="Delimiter">(</span>s<span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">)</span>sqr<span class="Statement">\</span>ad<span class="Special">;</span><span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">=</span>ad<span class="Delimiter">)</span><span class="Type">|</span><span class="Identifier">|</span><span class="Statement">/</span>a2sd<span class="Type">=</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">1</span><span class="Special">}</span>
totients<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">!</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Special">{[n1;r;p]</span> i<span class="Statement">:</span>p<span class="Type">*</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Delimiter">(</span><span class="Identifier">-</span>p<span class="Delimiter">)</span><span class="Type">!</span>n1<span class="Special">;</span>r<span class="Delimiter">[</span>i<span class="Delimiter">]</span><span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">-</span>p<span class="Delimiter">)</span><span class="Type">!</span>r<span class="Delimiter">[</span>i<span class="Delimiter">]</span><span class="Type">*</span>p<span class="Type">-</span><span class="Constant">1</span><span class="Special">;</span>r<span class="Special">}</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Statement">/</span>primes <span class="Special">x</span><span class="Special">}</span>
sigma1<span class="Statement">:</span><span class="Special">{</span>a<span class="Statement">:</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">#</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Special">{[r;p]</span> n<span class="Statement">:</span><span class="Identifier">#</span>r<span class="Special">;</span>m<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">-</span>p<span class="Delimiter">)</span><span class="Type">!</span>n<span class="Type">-</span><span class="Constant">1</span><span class="Special">;</span>q<span class="Statement">:</span><span class="Constant">-1</span><span class="Type">_</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)(</span>p<span class="Type">*</span><span class="Delimiter">)</span><span class="Statement">\</span>p<span class="Special">;</span><span class="Identifier">@</span><span class="Delimiter">[</span>r<span class="Delimiter">;</span>p<span class="Type">*</span><span class="Identifier">!</span>m<span class="Delimiter">;</span><span class="Identifier">*</span><span class="Delimiter">;</span><span class="Identifier">@</span><span class="Delimiter">[</span>m<span class="Type">#</span>p<span class="Type">+</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Constant">-1</span><span class="Type">_</span>q<span class="Delimiter">)</span><span class="Type">*</span><span class="Identifier">!</span><span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">-</span><span class="Constant">-1</span><span class="Type">_</span>q<span class="Delimiter">)</span><span class="Type">!</span><span class="Statement">'</span>m<span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Identifier">+</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Type">_</span>q<span class="Delimiter">]]</span><span class="Special">}</span><span class="Statement">/</span>p<span class="Statement">:</span>primes<span class="Constant"> 2</span><span class="Type">+</span><span class="Identifier">_%</span><span class="Special">x</span><span class="Comment"> /sum of divisors</span>
        p<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">#</span>p<span class="Delimiter">)</span><span class="Type">_</span>primes <span class="Special">x</span><span class="Special">;</span>a<span class="Delimiter">[</span>p<span class="Type">*</span><span class="Identifier">!</span><span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">-</span>p<span class="Delimiter">)</span><span class="Type">!</span><span class="Statement">'</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">#</span>a<span class="Delimiter">]</span><span class="Type">*:</span>p<span class="Type">+</span><span class="Constant">1</span><span class="Special">;</span>a<span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Statement">:</span><span class="Constant">0</span><span class="Special">;</span>a<span class="Special">}</span>
cfsqrt<span class="Statement">:</span><span class="Special">{</span>a0<span class="Statement">:</span><span class="Identifier">_%</span><span class="Special">x</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">=</span>a0<span class="Type">*</span>a0<span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Identifier">*|+</span><span class="Delimiter">(</span><span class="Identifier">~</span><span class="Delimiter">(</span><span class="Constant">2</span><span class="Type">*</span>a0<span class="Delimiter">)</span><span class="Type">=</span><span class="Identifier">*|:</span><span class="Delimiter">)(</span><span class="Special">{[N;a0;m;d;a]</span> m<span class="Statement">:</span><span class="Delimiter">(</span>d<span class="Type">*</span>a<span class="Delimiter">)</span><span class="Type">-</span>m<span class="Special">;</span>d<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">-</span>d<span class="Delimiter">)</span><span class="Type">!</span>N<span class="Type">-</span>m<span class="Type">*</span>m<span class="Special">;</span>a<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">-</span>d<span class="Delimiter">)</span><span class="Type">!</span>a0<span class="Type">+</span>m<span class="Special">;</span>m<span class="Type">,</span>d<span class="Type">,</span>a<span class="Special">}</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span>a0<span class="Delimiter">]</span><span class="Type">.</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Constant">0 1</span><span class="Type">,</span>a0<span class="Delimiter">]</span><span class="Special">}</span>
pell<span class="Statement">:</span>  <span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">=</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">_%</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Constant">0N</span><span class="Delimiter">;</span><span class="Delimiter">]</span><span class="Special">;</span>r<span class="Statement">:</span><span class="Identifier">|</span><span class="Constant">0 1</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Statement">/</span><span class="Identifier">|</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">|</span>c<span class="Statement">:</span><span class="Constant">-1</span><span class="Type">_</span>cfsqrt <span class="Special">x</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">2</span><span class="Type">!</span><span class="Identifier">#</span>c<span class="Delimiter">;</span><span class="Constant">1 0</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Statement">/'</span>r<span class="Type">*</span><span class="Identifier">*</span>r<span class="Delimiter">;</span>r<span class="Delimiter">]</span><span class="Special">}</span>
pelln1<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">=</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">_%</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Constant">0N</span><span class="Delimiter">;</span><span class="Delimiter">]</span><span class="Special">;</span>r<span class="Statement">:</span><span class="Identifier">|</span><span class="Constant">0 1</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Statement">/</span><span class="Identifier">|</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">|</span>c<span class="Statement">:</span><span class="Constant">-1</span><span class="Type">_</span>cfsqrt <span class="Special">x</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">2</span><span class="Type">!</span><span class="Identifier">#</span>c<span class="Delimiter">;</span>r<span class="Delimiter">;</span><span class="Constant">0N</span><span class="Delimiter">]</span><span class="Special">}</span>
gcd<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">*|</span><span class="Delimiter">(</span><span class="Identifier">*:</span><span class="Delimiter">)(</span><span class="Identifier">|!</span><span class="Statement">\</span><span class="Delimiter">)</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">,</span><span class="Special">y</span><span class="Special">}</span>
<span class="Comment">/combinatorics</span>
prm<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Special">{</span><span class="Identifier">,</span><span class="Statement">'/</span><span class="Delimiter">(</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">,</span><span class="Delimiter">(</span><span class="Identifier">#*</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Special">y</span><span class="Type">+</span><span class="Special">y</span><span class="Type">&gt;</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">1</span><span class="Special">}</span><span class="Statement">\:</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">,,</span><span class="Constant">0</span><span class="Special">}</span>
cmb<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">=</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Identifier">,!</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Identifier">,&amp;#</span><span class="Statement">'</span><span class="Identifier">*</span><span class="Statement">'</span>u<span class="Delimiter">)</span><span class="Type">,</span><span class="Identifier">,</span><span class="Statement">'/</span>u<span class="Statement">:</span>i<span class="Type">+</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Special">o</span><span class="Statement">'</span><span class="Special">y</span><span class="Type">-</span>i<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Special">y</span><span class="Type">-</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span>
gon<span class="Statement">:</span><span class="Special">{</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">y</span><span class="Type">*</span><span class="Delimiter">(</span><span class="Constant">4</span><span class="Type">-</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">2</span><span class="Delimiter">)</span><span class="Type">*</span><span class="Special">y</span><span class="Special">}</span><span class="Comment"> /y-th x-agonal number</span>
<span class="Comment">/bignum</span>
big<span class="Statement">:</span><span class="Constant">10</span><span class="Statement">\</span>
small<span class="Statement">:</span><span class="Constant">10</span><span class="Statement">/</span>
carry<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">~**</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">_</span><span class="Delimiter">((</span><span class="Identifier">*</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Constant">0</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Constant">0</span><span class="Type">,</span><span class="Identifier">*|</span><span class="Special">x</span><span class="Statement">:</span><span class="Constant">0 10</span><span class="Statement">\</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span>
sum<span class="Statement">:</span><span class="Special">{</span>carry<span class="Type">@</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">&amp;</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Identifier">|</span><span class="Statement">/</span>l<span class="Delimiter">)</span><span class="Type">-</span>l<span class="Statement">:</span><span class="Identifier">#</span><span class="Statement">'</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span>
add<span class="Statement">:</span><span class="Special">{</span>sum<span class="Delimiter">(</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Special">}</span>
mul<span class="Statement">:</span><span class="Special">{</span>carry<span class="Type">@</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span><span class="Constant">-1</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Identifier">#</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Identifier">!#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Statement">\:</span><span class="Identifier">!#</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Identifier">+</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Type">*</span><span class="Statement">\:</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Special">}</span>
max<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Delimiter">(</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">&lt;</span><span class="Identifier">#</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Identifier">#</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Type">&lt;</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Type">&lt;</span><span class="Identifier">*</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">-</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Type">^</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Special">}</span>
lt<span class="Statement">:</span><span class="Special">{</span>d<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">-</span><span class="Identifier">#</span><span class="Special">y</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span>d<span class="Delimiter">;</span>d<span class="Type">&lt;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Identifier">*&gt;</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Delimiter">]</span><span class="Special">}</span>
sqrt<span class="Statement">:</span><span class="Special">{[a]</span> <span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">,</span><span class="Identifier">&amp;</span>l<span class="Delimiter">)</span><span class="Special">{[a;r;i]</span> <span class="Special">{[a;i;r]</span> R<span class="Statement">:</span>r<span class="Special">;</span>R<span class="Delimiter">[</span>i<span class="Delimiter">]</span><span class="Type">+:</span><span class="Constant">1</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span>lt<span class="Delimiter">[</span>mul<span class="Delimiter">[</span>R<span class="Delimiter">;</span>R<span class="Delimiter">]</span><span class="Delimiter">;</span>a<span class="Delimiter">]</span><span class="Delimiter">;</span>R<span class="Delimiter">;</span>r<span class="Delimiter">]</span><span class="Special">}</span><span class="Delimiter">[</span>a<span class="Delimiter">;</span>i<span class="Delimiter">]</span><span class="Statement">/</span>r<span class="Special">}</span><span class="Delimiter">[</span>a<span class="Delimiter">]</span><span class="Statement">/</span><span class="Identifier">!</span>l<span class="Statement">:</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">#</span>a<span class="Special">}</span>

P<span class="Statement">:</span><span class="Special">{</span><span class="Constant">1</span><span class="Type">@</span><span class="Constant">&quot;P &quot;</span><span class="Type">,</span><span class="Delimiter">(</span><span class="Identifier">$</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">&quot;</span><span class="Special">;</span><span class="Special">}</span>
P<span class="Constant"> 1</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">&amp;|</span><span class="Statement">/</span><span class="Identifier">~</span><span class="Constant">5 3</span><span class="Type">!</span><span class="Statement">\:</span><span class="Identifier">!</span><span class="Constant">1000</span>
P<span class="Constant"> 2</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">~</span><span class="Constant">2</span><span class="Type">!</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Identifier">*+</span><span class="Constant">-1</span><span class="Type">_</span><span class="Delimiter">(</span><span class="Identifier">*</span><span class="Constant">4000000</span><span class="Type">&gt;</span><span class="Delimiter">)(</span><span class="Identifier">|+</span><span class="Statement">\</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Identifier">!</span><span class="Constant">2</span>
P<span class="Constant"> 3</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">600851475143</span><span class="Special">;</span>p<span class="Statement">:</span>primes<span class="Constant"> 2</span><span class="Type">+</span><span class="Identifier">_%</span>n<span class="Special">;</span><span class="Identifier">|</span><span class="Statement">/</span>p<span class="Type">@</span><span class="Identifier">&amp;~</span>p<span class="Type">!</span><span class="Statement">'</span>n
P<span class="Constant"> 4</span><span class="Special">;</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Special">{</span><span class="Special">x</span><span class="Type">~</span><span class="Identifier">|</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span><span class="Identifier">$,</span><span class="Statement">/</span>a<span class="Type">*</span><span class="Statement">\:</span>a<span class="Statement">:</span><span class="Constant">100</span><span class="Type">_</span><span class="Identifier">!</span><span class="Constant">1000</span>
P<span class="Constant"> 5</span><span class="Special">;</span>lcm<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">-</span>gcd<span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Delimiter">)</span><span class="Type">!</span><span class="Special">x</span><span class="Type">*</span><span class="Special">y</span><span class="Special">}</span><span class="Special">;</span>lcm<span class="Statement">/</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">20</span>
P<span class="Constant"> 6</span><span class="Special">;</span><span class="Delimiter">(</span>s<span class="Type">*</span>s<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span>i<span class="Delimiter">)</span><span class="Type">-</span><span class="Identifier">+</span><span class="Statement">/</span>i<span class="Type">*</span>i<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">100</span>
P<span class="Constant"> 7</span><span class="Special">;</span>primes<span class="Delimiter">[</span><span class="Constant">200000</span><span class="Delimiter">]</span><span class="Constant">10000</span>
P<span class="Constant"> 8</span><span class="Special">;</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">-|</span>i<span class="Delimiter">)</span><span class="Type">_</span><span class="Statement">'</span><span class="Delimiter">(</span>i<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">13</span><span class="Delimiter">)</span><span class="Type">_</span><span class="Statement">\:</span>a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p008.txt&quot;</span>
P<span class="Constant"> 9</span><span class="Special">;</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Delimiter">(</span>ab<span class="Type">,</span><span class="Identifier">,</span>c<span class="Delimiter">)</span><span class="Type">@</span><span class="Statement">\:</span><span class="Identifier">&amp;</span><span class="Delimiter">(</span><span class="Identifier">+</span><span class="Statement">/</span>ab<span class="Type">*</span>ab<span class="Delimiter">)</span><span class="Type">=</span>c<span class="Type">*</span>c<span class="Statement">:</span><span class="Constant">1000</span><span class="Type">-</span><span class="Identifier">+</span><span class="Statement">/</span>ab<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">2</span><span class="Type">#</span><span class="Constant">1000</span>
P<span class="Constant"> 10</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span>primes<span class="Constant"> 2000000</span>
P<span class="Constant"> 11</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">''</span><span class="Constant">&quot; &quot;</span><span class="Statement">\'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p011.txt&quot;</span><span class="Special">;</span>u<span class="Statement">:</span><span class="Identifier">&amp;</span><span class="Statement">'</span><span class="Identifier">!#</span>a<span class="Special">;</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">,</span><span class="Statement">//</span><span class="Identifier">*</span><span class="Statement">/''</span><span class="Constant">4</span><span class="Statement">''</span><span class="Delimiter">(</span>a<span class="Delimiter">;</span><span class="Identifier">+</span>a<span class="Delimiter">;</span>u<span class="Type">,</span><span class="Statement">'</span>a<span class="Type">,</span><span class="Statement">'</span><span class="Identifier">|</span>u<span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Identifier">|</span>u<span class="Delimiter">)</span><span class="Type">,</span><span class="Statement">'</span>a<span class="Type">,</span><span class="Statement">'</span>u<span class="Delimiter">)</span>
P<span class="Constant"> 12</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">100000</span>
     a<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span>n<span class="Delimiter">;</span>q<span class="Type">*</span><span class="Identifier">!</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Identifier">-</span>q<span class="Statement">:</span><span class="Constant">-1</span><span class="Type">_</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)(</span><span class="Special">x</span><span class="Type">*</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">!</span><span class="Statement">'</span>n<span class="Delimiter">;</span><span class="Identifier">+</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">'</span>primes<span class="Constant"> 2</span><span class="Type">+</span><span class="Identifier">_%</span>n
     a<span class="Type">,:</span><span class="Identifier">,~+</span><span class="Statement">/</span>a
     a<span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Statement">:</span><span class="Constant">0</span><span class="Type">|</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">*</span>a
     d<span class="Statement">:</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">+</span><span class="Statement">':'</span>a
     d<span class="Delimiter">[</span><span class="Identifier">!</span><span class="Constant">2</span><span class="Delimiter">]</span><span class="Statement">:</span><span class="Constant">1</span>
<span class="Constant">     -2</span><span class="Type">!</span>i<span class="Type">*</span><span class="Constant">-1</span><span class="Type">+</span>i<span class="Statement">:</span><span class="Identifier">*&amp;</span>d<span class="Type">&gt;</span><span class="Constant">500</span>
P<span class="Constant"> 13</span><span class="Special">;</span>small<span class="Constant"> 10</span><span class="Type">#</span>add<span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p013.txt&quot;</span><span class="Delimiter">)</span><span class="Type">-</span><span class="Constant">&quot;0&quot;</span>
P<span class="Constant"> 14</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1000000</span>
     c<span class="Statement">:</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span>n<span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Comment"> /cached collatz chain lengths</span>
     f<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span>v<span class="Statement">:</span><span class="Constant">0</span><span class="Type">|</span>c <span class="Special">x</span><span class="Delimiter">;</span><span class="Statement">:</span>v<span class="Delimiter">;</span><span class="Delimiter">]</span>
        v<span class="Statement">:</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">2</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">2</span><span class="Type">+</span><span class="Special">o</span><span class="Type">@</span><span class="Constant">2</span><span class="Type">+</span><span class="Constant">3</span><span class="Type">*</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Type">+</span><span class="Special">o</span><span class="Type">@</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Comment"> /if x is odd, take two steps at a time</span>
        <span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">&lt;</span>n<span class="Delimiter">;</span>c<span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Statement">:</span>v<span class="Delimiter">;</span>v<span class="Delimiter">]</span><span class="Special">}</span>
     <span class="Identifier">*&amp;</span>r<span class="Type">=</span><span class="Identifier">|</span><span class="Statement">/</span>r<span class="Statement">:</span>f<span class="Statement">'</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">!</span>n<span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span>
P<span class="Constant"> 15</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">20</span><span class="Special">;</span><span class="Identifier">*|</span>n<span class="Delimiter">(</span><span class="Identifier">+</span><span class="Statement">\</span><span class="Delimiter">)</span><span class="Statement">/</span><span class="Constant">1</span><span class="Type">,</span>n<span class="Type">#</span><span class="Constant">1</span>
P<span class="Constant"> 16</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">1000</span><span class="Special">{</span>add<span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">/</span>big<span class="Constant"> 1</span>
P<span class="Constant"> 17</span><span class="Special">;</span>d<span class="Statement">:</span><span class="Identifier">#</span><span class="Constant">&quot;OneTwoThreeFourFiveSixSevenEightNine&quot;</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Constant">100</span><span class="Type">*</span>d
<span class="Constant">        9</span><span class="Type">*</span><span class="Constant">100</span><span class="Type">*</span><span class="Identifier">#</span><span class="Constant">&quot;Hundred&quot;</span>
<span class="Constant">        9</span><span class="Type">*</span><span class="Constant">99</span><span class="Type">*</span><span class="Identifier">#</span><span class="Constant">&quot;And&quot;</span>
<span class="Constant">        10</span><span class="Type">*</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span>d
              <span class="Identifier">#</span><span class="Constant">&quot;TenElevenTwelveThirteenFourteenFifteenSixteenSeventeenEighteenNineteen&quot;</span>
<span class="Constant">              10</span><span class="Type">*</span><span class="Identifier">#</span><span class="Constant">&quot;TwentyThirtyFortyFiftySixtySeventyEightyNinety&quot;</span>
<span class="Constant">              8</span><span class="Type">*</span>d<span class="Delimiter">)</span>
        <span class="Identifier">#</span><span class="Constant">&quot;OneThousand&quot;</span><span class="Delimiter">)</span>
P<span class="Constant"> 18</span><span class="Special">;</span><span class="Identifier">*</span><span class="Special">{</span><span class="Special">y</span><span class="Type">+</span><span class="Constant">1</span><span class="Type">_</span><span class="Identifier">|</span><span class="Statement">':</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">|.</span><span class="Statement">''</span><span class="Constant">&quot; &quot;</span><span class="Statement">\'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p018.txt&quot;</span>
P<span class="Constant"> 19</span><span class="Special">;</span>m<span class="Statement">:</span><span class="Constant">31 28 31 30 31 30 31 31 30 31 30 31</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">6</span><span class="Type">=</span><span class="Constant">7</span><span class="Type">!</span><span class="Delimiter">(</span><span class="Identifier">+</span><span class="Statement">/</span>m<span class="Delimiter">)</span><span class="Type">+</span><span class="Statement">\</span><span class="Constant">0</span><span class="Type">,</span><span class="Constant">-1</span><span class="Type">_</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Constant">100</span><span class="Type">#</span><span class="Delimiter">(</span><span class="Constant">3</span><span class="Type">#</span><span class="Identifier">,</span>m<span class="Delimiter">)</span><span class="Type">,</span><span class="Identifier">,@</span><span class="Delimiter">[</span>m<span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Identifier">+</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span>
P<span class="Constant"> 20</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span>mul<span class="Statement">/</span>big<span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">100</span>
P<span class="Constant"> 21</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">10000</span><span class="Special">;</span>i<span class="Statement">:</span><span class="Identifier">!</span>n<span class="Special">;</span>s<span class="Statement">:</span>sigma1<span class="Delimiter">[</span>n<span class="Delimiter">]</span><span class="Type">-</span>i<span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">&amp;</span><span class="Delimiter">(</span>i<span class="Type">=</span>s s<span class="Delimiter">)</span><span class="Type">&gt;</span>i<span class="Type">=</span>s
P<span class="Constant"> 22</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!#</span>a<span class="Delimiter">)</span><span class="Type">*</span>a<span class="Type">@</span><span class="Identifier">&lt;</span>a<span class="Statement">:</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">-</span><span class="Constant">&quot;A&quot;</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Constant">&quot;,&quot;</span><span class="Statement">\</span><span class="Identifier">1:</span><span class="Constant">&quot;i/p022_names.txt&quot;</span>
P<span class="Constant"> 23</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">28123</span>
     a<span class="Statement">:</span><span class="Identifier">&amp;</span>sigma1<span class="Delimiter">[</span>n<span class="Delimiter">]</span><span class="Type">&gt;</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">!</span>n<span class="Comment"> /abundant numbers</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">&amp;@</span><span class="Delimiter">[</span>n<span class="Type">#</span><span class="Constant">1</span><span class="Delimiter">;</span>a<span class="Type">*</span>n<span class="Type">&gt;</span>a<span class="Type">+:</span><span class="Identifier">,</span><span class="Statement">\</span>a<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">]</span>
P<span class="Constant"> 24</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">10</span><span class="Special">;</span><span class="Identifier">.,</span><span class="Statement">/</span><span class="Identifier">$</span><span class="Special">{</span>a<span class="Type">^:</span>r<span class="Statement">:</span>a <span class="Special">x</span><span class="Special">;</span>r<span class="Special">}</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Identifier">-!</span><span class="Constant">-10</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Constant">1000000</span><span class="Type">-</span><span class="Constant">1</span>
P<span class="Constant"> 25</span><span class="Special">;</span><span class="Identifier">#</span><span class="Special">{</span><span class="Constant">1000</span><span class="Type">&gt;</span><span class="Identifier">#*</span><span class="Special">x</span><span class="Special">}{</span>add<span class="Statement">\</span><span class="Identifier">|</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">\</span>big<span class="Statement">'</span><span class="Constant">1 1</span>
P<span class="Constant"> 26</span><span class="Special">;</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">*&gt;</span>r<span class="Statement">:</span><span class="Special">{</span>m<span class="Statement">::</span><span class="Special">x</span><span class="Special">;</span><span class="Delimiter">(</span><span class="Identifier">#</span>a<span class="Delimiter">)</span><span class="Type">-</span><span class="Constant">1</span><span class="Type">+</span>a<span class="Type">?</span>l<span class="Statement">:</span><span class="Identifier">*|</span>a<span class="Statement">:</span><span class="Special">{</span>l<span class="Type">&amp;</span><span class="Constant">2</span><span class="Type">&gt;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">=</span>l<span class="Statement">:</span><span class="Identifier">*|</span><span class="Special">x</span><span class="Special">}{</span><span class="Special">x</span><span class="Type">,</span>m<span class="Type">!</span><span class="Constant">10</span><span class="Type">*</span><span class="Identifier">*|</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">,</span><span class="Constant">1</span><span class="Special">}</span><span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">1000</span>
P<span class="Constant"> 27</span><span class="Special">;</span>maxp<span class="Statement">:</span><span class="Constant">20000</span>
     sieve<span class="Statement">:</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span>maxp<span class="Delimiter">;</span>primes maxp<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span>
     ab<span class="Statement">:</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Statement">'</span><span class="Identifier">!#</span><span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span><span class="Delimiter">(</span><span class="Constant">-1000</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">2001</span><span class="Delimiter">;</span>primes<span class="Constant"> 1000</span><span class="Delimiter">)</span>
     <span class="Special">{</span>i<span class="Statement">:</span><span class="Identifier">&amp;</span><span class="Constant">1</span><span class="Type">=</span>sieve<span class="Type">@</span>v<span class="Statement">:</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">*</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">*</span>ab<span class="Constant"> 0</span><span class="Delimiter">)</span><span class="Type">+</span>ab<span class="Constant"> 1</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span>maxp<span class="Type">&lt;</span><span class="Identifier">|</span><span class="Statement">/</span>v<span class="Delimiter">;</span>ERR<span class="Delimiter">;</span><span class="Identifier">~#</span>i<span class="Delimiter">;</span><span class="Statement">:</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">;</span>ab<span class="Statement">::</span>ab<span class="Type">@</span><span class="Statement">\:</span>i<span class="Special">;</span><span class="Special">x</span><span class="Type">+</span><span class="Constant">1</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">1</span><span class="Special">;</span>
     <span class="Identifier">**</span><span class="Statement">/</span>ab
P<span class="Constant"> 28</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1001</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Statement">\</span><span class="Constant">1</span><span class="Type">,</span><span class="Statement">/</span><span class="Constant">4</span><span class="Type">#</span><span class="Statement">'</span><span class="Constant">2</span><span class="Type">*</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">-2</span><span class="Type">!</span>n
P<span class="Constant"> 29</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">100</span><span class="Special">;</span>i<span class="Statement">:</span>big<span class="Statement">'</span><span class="Constant">2</span><span class="Type">+</span><span class="Identifier">!</span>n<span class="Type">-</span><span class="Constant">1</span><span class="Special">;</span><span class="Identifier">#?,</span><span class="Statement">/</span><span class="Constant">1</span><span class="Type">_</span><span class="Delimiter">(</span>n<span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Special">{</span>i mul<span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">\</span>i
P<span class="Constant"> 30</span><span class="Special">;</span>p<span class="Statement">:</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">5</span><span class="Type">#</span><span class="Identifier">,!</span><span class="Constant">10</span>
     s<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span>p<span class="Type">@</span><span class="Identifier">!</span><span class="Constant">6</span><span class="Type">#</span><span class="Constant">10</span>
<span class="Constant">     -1</span><span class="Type">+</span><span class="Statement">/</span><span class="Identifier">&amp;</span>s<span class="Type">=</span><span class="Identifier">!#</span>s
P<span class="Constant"> 31</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Constant">1</span><span class="Type">,</span><span class="Identifier">&amp;</span><span class="Constant">200</span><span class="Special">;</span><span class="Constant">1 2 5 10 20 50 100 200</span><span class="Special">{</span>a<span class="Delimiter">[</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Type">+:</span><span class="Constant">0</span><span class="Type">|</span>a<span class="Delimiter">[</span><span class="Special">y</span><span class="Type">-</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">;</span><span class="Special">}</span><span class="Statement">/:\:</span><span class="Identifier">!#</span>a<span class="Special">;</span><span class="Identifier">*|</span>a
P<span class="Constant"> 32</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">,</span><span class="Statement">'/</span><span class="Constant">10</span><span class="Statement">/''</span><span class="Delimiter">(</span><span class="Constant">0 2 5</span><span class="Delimiter">;</span><span class="Constant">0 1 5</span><span class="Delimiter">)</span><span class="Type">_</span><span class="Statement">\:</span><span class="Constant">1</span><span class="Type">+</span>prm<span class="Constant"> 9</span><span class="Comment"> /x*yyyy=zzzz or xx*yyy=zzzz</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">?*|</span>a<span class="Type">@</span><span class="Statement">\:</span><span class="Identifier">&amp;</span>a<span class="Delimiter">[</span><span class="Constant">2</span><span class="Delimiter">]</span><span class="Type">=</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span>a
P<span class="Constant"> 33</span><span class="Special">;</span>frac<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">-</span>gcd<span class="Statement">/</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">!</span><span class="Special">x</span><span class="Special">}</span><span class="Comment"> /lowest terms</span>
     r<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">&lt;</span><span class="Statement">/</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">&amp;</span><span class="Identifier">~=</span><span class="Statement">/</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span><span class="Identifier">?,</span><span class="Statement">/</span><span class="Special">{</span>a<span class="Type">@</span><span class="Identifier">&amp;</span><span class="Delimiter">(</span><span class="Identifier">&amp;</span><span class="Statement">/'</span>a<span class="Type">&gt;</span><span class="Constant">9</span><span class="Delimiter">)</span><span class="Type">&amp;</span><span class="Delimiter">(</span>frac <span class="Special">x</span><span class="Constant"> 1 2</span><span class="Delimiter">)</span><span class="Type">~</span><span class="Statement">/:</span>frac<span class="Statement">'</span>a<span class="Statement">:</span><span class="Constant">10</span><span class="Statement">/''</span><span class="Special">x</span><span class="Delimiter">((</span><span class="Constant">0 1</span><span class="Delimiter">;</span><span class="Constant">0 2</span><span class="Delimiter">)</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Constant">0 1</span><span class="Delimiter">;</span><span class="Constant">2 0</span><span class="Delimiter">)</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Constant">1 0</span><span class="Delimiter">;</span><span class="Constant">0 2</span><span class="Delimiter">)</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Constant">1 0</span><span class="Delimiter">;</span><span class="Constant">0 2</span><span class="Delimiter">))</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">+!</span><span class="Constant">3</span><span class="Type">#</span><span class="Constant">10</span>
     <span class="Identifier">*|</span>frac<span class="Type">@</span><span class="Identifier">*</span><span class="Statement">/</span>r
P<span class="Constant"> 34</span><span class="Special">;</span>f<span class="Statement">:</span><span class="Identifier">*</span><span class="Statement">\</span><span class="Constant">1</span><span class="Type">|</span><span class="Identifier">!</span><span class="Constant">10</span>
     a<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">6</span><span class="Type">#</span><span class="Constant">10</span>
     lz<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">#</span>a<span class="Delimiter">)</span><span class="Type">-</span><span class="Identifier">&amp;</span><span class="Constant">1</span><span class="Type">,</span><span class="Constant">9</span><span class="Type">*</span><span class="Statement">\</span><span class="Constant">1</span><span class="Type">,</span><span class="Delimiter">(</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">#</span>a<span class="Delimiter">)</span><span class="Type">#</span><span class="Constant">10</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">3</span><span class="Type">_</span><span class="Identifier">&amp;</span><span class="Delimiter">(</span><span class="Identifier">!#*</span>a<span class="Delimiter">)</span><span class="Type">=</span><span class="Delimiter">(</span><span class="Identifier">+</span><span class="Statement">/</span>f a<span class="Delimiter">)</span><span class="Type">-</span>lz
P<span class="Constant"> 35</span><span class="Special">;</span><span class="Constant">2</span><span class="Type">+</span><span class="Identifier">#</span><span class="Special">{</span><span class="Special">x</span><span class="Type">^</span><span class="Special">x</span><span class="Type">^</span><span class="Special">{</span><span class="Identifier">.,</span><span class="Statement">/</span><span class="Identifier">|</span><span class="Constant">0 1</span><span class="Type">_</span><span class="Identifier">$</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Special">{</span><span class="Identifier">~|</span><span class="Statement">/</span><span class="Identifier">^</span><span class="Constant">&quot;1379&quot;</span><span class="Type">?</span><span class="Identifier">$</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span>primes<span class="Constant"> 1000000</span><span class="Comment"> /+2 because 2 and 5 don't match /[1379]+/</span>
P<span class="Constant"> 36</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">&amp;</span><span class="Special">{</span><span class="Delimiter">(</span>a<span class="Type">~</span><span class="Identifier">|</span>a<span class="Statement">:</span><span class="Constant">2</span><span class="Statement">\</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">&amp;</span>a<span class="Type">~</span><span class="Identifier">|</span>a<span class="Statement">:</span><span class="Constant">10</span><span class="Statement">\</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">!</span><span class="Constant">1000000</span>
P<span class="Constant"> 37</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Constant">7</span><span class="Type">&lt;</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Special">{</span><span class="Identifier">&amp;</span><span class="Statement">/</span>isprime<span class="Statement">'</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Identifier">|</span><span class="Statement">'</span><span class="Identifier">,</span><span class="Statement">\</span><span class="Identifier">|$</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">{</span>isprime<span class="Type">#</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">!</span><span class="Constant">10</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Statement">/:</span><span class="Constant">10</span><span class="Type">*</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">\</span><span class="Constant">2 3 5 7</span>
P<span class="Constant"> 38</span><span class="Special">;</span>i<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">10000</span>
     a<span class="Statement">:</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Identifier">,</span><span class="Statement">'\</span><span class="Identifier">$</span><span class="Constant">8</span><span class="Delimiter">(</span>i<span class="Type">+</span><span class="Delimiter">)</span><span class="Statement">\</span>i
     d<span class="Statement">:</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Identifier">$</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">9</span>
     <span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Special">{</span>d<span class="Type">~</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">&lt;</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span><span class="Special">{</span><span class="Constant">9</span><span class="Type">=</span><span class="Identifier">#</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span>a
P<span class="Constant"> 39</span><span class="Special">;</span>l<span class="Statement">:</span><span class="Constant">1000</span><span class="Special">;</span>mn<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">|</span>cmb<span class="Delimiter">[</span><span class="Constant">2</span><span class="Delimiter">;</span>l<span class="Delimiter">]</span><span class="Special">;</span>p<span class="Statement">:</span><span class="Constant">2</span><span class="Type">*</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Statement">\</span>mn<span class="Comment"> /primitive triples: a=m^2-n^2 b=2mn c=m^2+n^2 P=2m(m+n) where gcd(m,n)=1 and m&gt;n&gt;0</span>
     i<span class="Statement">:</span><span class="Identifier">&amp;</span>p<span class="Type">&lt;</span>l<span class="Type">+</span><span class="Constant">1</span>
     p<span class="Type">@:</span>i
     mn<span class="Statement">:</span>mn<span class="Type">@</span><span class="Statement">\:</span>i
     p<span class="Type">@:</span><span class="Identifier">&amp;</span><span class="Constant">1</span><span class="Type">=</span>gcd<span class="Statement">'/</span>mn
     <span class="Identifier">*&gt;#</span><span class="Statement">'</span><span class="Identifier">=,</span><span class="Statement">/</span>p<span class="Type">*</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Identifier">-</span>p<span class="Delimiter">)</span><span class="Type">!</span><span class="Statement">'</span>l
P<span class="Constant"> 40</span><span class="Special">;</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Identifier">$!</span><span class="Constant">1000000</span><span class="Delimiter">)</span><span class="Type">@</span><span class="Constant">6</span><span class="Delimiter">(</span><span class="Constant">10</span><span class="Type">*</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Constant">1</span>
P<span class="Constant"> 41</span><span class="Special">;</span>mp<span class="Statement">:</span><span class="Identifier">_%</span><span class="Constant">10000</span>
     p<span class="Statement">:</span>primes mp
     isp<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">~</span><span class="Constant">2 3 5 7</span><span class="Type">!</span><span class="Statement">'</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Type">&lt;</span>mp<span class="Delimiter">;</span><span class="Identifier">~^</span>p<span class="Type">?</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Identifier">~|</span><span class="Statement">/</span><span class="Identifier">~</span>p<span class="Type">!</span><span class="Statement">'</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span>
     <span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">{</span>isp<span class="Type">#</span><span class="Constant">10</span><span class="Statement">/</span><span class="Constant">1</span><span class="Type">+</span>prm <span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Constant">4 7</span><span class="Comment"> /digit sum of other pandigitals is divisible by 3</span>
P<span class="Constant"> 42</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/'</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">-</span><span class="Constant">&quot;A&quot;</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Constant">1</span><span class="Type">_</span><span class="Statement">'</span><span class="Constant">-1</span><span class="Type">_</span><span class="Statement">'</span><span class="Constant">&quot;,&quot;</span><span class="Statement">\</span><span class="Identifier">1:</span><span class="Constant">&quot;i/p042_words.txt&quot;</span>
     t<span class="Statement">:</span><span class="Special">{</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">x</span><span class="Type">*</span><span class="Constant">1</span><span class="Type">+</span><span class="Special">x</span><span class="Special">}</span><span class="Type">@</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">-2</span><span class="Type">!</span><span class="Identifier">*|</span><span class="Statement">/</span>a
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">~^</span>t<span class="Type">?</span>a
P<span class="Constant"> 43</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">10</span><span class="Statement">/</span>p<span class="Type">@</span><span class="Statement">\:</span><span class="Identifier">&amp;~+</span><span class="Statement">/</span>primes<span class="Delimiter">[</span><span class="Constant">18</span><span class="Delimiter">]</span><span class="Type">!</span><span class="Statement">'</span><span class="Constant">10</span><span class="Statement">/'</span><span class="Constant">3</span><span class="Statement">'</span><span class="Constant">1</span><span class="Type">_</span>p<span class="Statement">:</span>prm<span class="Constant"> 10</span>
P<span class="Constant"> 44</span><span class="Special">;</span>p<span class="Statement">:</span>gon<span class="Delimiter">[</span><span class="Constant">5</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">3000</span><span class="Delimiter">]</span>
     h<span class="Statement">:</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">*|</span>p<span class="Delimiter">;</span>p<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span>
     p<span class="Type">@</span><span class="Identifier">*&amp;</span><span class="Constant">0</span><span class="Type">&lt;</span><span class="Identifier">+</span><span class="Statement">/'</span><span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Constant">0</span><span class="Type">|</span>h<span class="Delimiter">(</span>p<span class="Type">+</span><span class="Statement">\:</span>p<span class="Delimiter">;</span>p<span class="Type">+</span><span class="Statement">\:</span><span class="Constant">2</span><span class="Type">*</span>p<span class="Delimiter">)</span>
P<span class="Constant"> 45</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Constant">3 5 6</span>  gon<span class="Statement">\:</span><span class="Identifier">!</span><span class="Constant">1000000</span>
     i<span class="Statement">:</span><span class="Identifier">&amp;#</span>a
<span class="Constant">     3</span><span class="Special">{</span>i<span class="Type">+:</span><span class="Constant">1</span><span class="Special">;</span><span class="Special">{</span><span class="Identifier">~</span><span class="Special">x</span><span class="Special">}{</span>v<span class="Statement">:</span>a<span class="Type">@</span><span class="Statement">'</span>i<span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span><span class="Statement">/</span>v<span class="Type">=</span><span class="Identifier">*</span>v<span class="Delimiter">;</span><span class="Statement">:</span><span class="Identifier">*</span>v<span class="Delimiter">;</span><span class="Delimiter">]</span><span class="Special">;</span>i<span class="Delimiter">[</span><span class="Identifier">*&lt;</span>v<span class="Delimiter">]</span><span class="Type">+:</span><span class="Constant">1</span><span class="Special">;</span><span class="Constant">0</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">0</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">0</span>
P<span class="Constant"> 46</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">10000</span>
     p<span class="Statement">:</span>primes n
     s<span class="Statement">:</span><span class="Constant">2</span><span class="Type">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,!</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">_%</span><span class="Constant">-2</span><span class="Type">!</span>n
     <span class="Identifier">*</span><span class="Constant">1</span><span class="Type">_</span><span class="Identifier">&amp;@</span><span class="Delimiter">[</span><span class="Delimiter">(</span>n<span class="Type">+</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Constant">0 1</span><span class="Delimiter">;</span><span class="Delimiter">(</span>n<span class="Type">&amp;</span>s<span class="Type">+</span><span class="Statement">\:</span>p<span class="Delimiter">;</span>p<span class="Delimiter">)</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">]</span>
P<span class="Constant"> 47</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1000000</span><span class="Special">;</span>k<span class="Statement">:</span><span class="Constant">4</span><span class="Special">;</span>p<span class="Statement">:</span>primes<span class="Constant"> 2</span><span class="Type">+</span><span class="Identifier">_%</span>n
     omega<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">&amp;</span>n<span class="Delimiter">)</span><span class="Special">{</span><span class="Special">x</span><span class="Delimiter">[</span><span class="Special">y</span><span class="Type">*</span><span class="Identifier">!</span><span class="Delimiter">(</span><span class="Identifier">-</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Type">!</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Type">+:</span><span class="Constant">1</span><span class="Special">;</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span>p<span class="Comment"> /number of prime factors (or 0 for primes larger than sqrt n)</span>
     <span class="Identifier">*</span><span class="Constant">1</span><span class="Type">-</span>k<span class="Type">-</span><span class="Identifier">&amp;</span><span class="Delimiter">(</span>k<span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Type">&amp;</span><span class="Statement">':/</span>k<span class="Type">=</span>omega
P<span class="Constant"> 48</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1000</span><span class="Special">;</span>m<span class="Statement">:</span><span class="Constant">10000000000</span><span class="Special">;</span>h<span class="Statement">:</span><span class="Identifier">_%</span>m
     sqr<span class="Statement">:</span><span class="Special">{</span>a<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">-</span>h<span class="Delimiter">)</span><span class="Type">!</span><span class="Special">x</span><span class="Special">;</span>b<span class="Statement">:</span>h<span class="Type">!</span><span class="Special">x</span><span class="Special">;</span>m<span class="Type">!</span>b<span class="Type">*</span>b<span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span>h<span class="Type">*</span>a<span class="Special">}</span>
     pow<span class="Statement">:</span><span class="Special">{</span>m<span class="Type">!</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">2</span><span class="Type">!</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Type">*</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">y</span><span class="Type">&gt;</span><span class="Constant">1</span><span class="Delimiter">;</span>m<span class="Type">!</span>sqr <span class="Special">o</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Special">}</span>
     m<span class="Type">!</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Special">{</span>pow<span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span>n
P<span class="Constant"> 49</span><span class="Special">;</span>p<span class="Statement">:</span><span class="Delimiter">(</span><span class="Constant">999</span><span class="Type">&lt;</span><span class="Delimiter">)</span><span class="Type">#</span>primes<span class="Constant"> 10000</span>
     triples<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">+</span>i<span class="Delimiter">)</span><span class="Type">@</span><span class="Identifier">&amp;&amp;</span><span class="Statement">/</span><span class="Constant">-1</span><span class="Type">&gt;</span><span class="Statement">':</span>i<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">3</span><span class="Type">#</span><span class="Special">x</span><span class="Special">}</span>
     r<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">=</span><span class="Statement">/</span><span class="Constant">1</span><span class="Type">_</span><span class="Identifier">-</span><span class="Statement">':</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span>triples<span class="Type">@</span><span class="Identifier">#</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Special">{</span><span class="Constant">2</span><span class="Type">&lt;</span><span class="Identifier">#</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span>p<span class="Type">@</span><span class="Identifier">.=</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">&lt;</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">$</span>p
     <span class="Identifier">.,</span><span class="Statement">/</span><span class="Identifier">$*</span>r<span class="Type">^</span><span class="Identifier">,</span><span class="Constant">1487 4817 8147</span>
P<span class="Constant"> 50</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1000000</span><span class="Special">;</span>p<span class="Statement">:</span>primes n
     a<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">0</span>
     b<span class="Statement">:</span><span class="Constant">-1</span><span class="Type">_</span>p
     <span class="Special">{</span><span class="Special">x</span><span class="Special">}{</span>b<span class="Type">+:</span><span class="Delimiter">(</span><span class="Identifier">#</span>b<span class="Delimiter">)</span><span class="Type">#</span><span class="Special">x</span><span class="Type">_</span>p<span class="Special">;</span>b<span class="Statement">::</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span>b<span class="Special">;</span>a<span class="Type">,:</span>b<span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Identifier">#</span>b<span class="Delimiter">;</span><span class="Special">x</span><span class="Type">+</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">1</span><span class="Special">;</span>
     sieve<span class="Statement">:</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span>n<span class="Delimiter">;</span>p<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span>
     <span class="Identifier">*|</span><span class="Special">{</span><span class="Constant">0</span><span class="Type">|</span>sieve <span class="Special">x</span><span class="Special">}</span><span class="Type">#</span>a
P<span class="Constant"> 51</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1000000</span>
     p<span class="Statement">:</span>primes n
     h<span class="Statement">:</span><span class="Identifier">@</span><span class="Delimiter">[</span>n<span class="Type">#</span><span class="Constant">0x00</span><span class="Delimiter">;</span>p<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">0x01</span><span class="Delimiter">]</span><span class="Comment"> /sieve</span>
     f<span class="Statement">:</span><span class="Special">{</span>a<span class="Statement">:</span><span class="Constant">10</span><span class="Statement">\</span><span class="Special">x</span>
        m<span class="Statement">:</span><span class="Constant">1</span><span class="Type">_</span><span class="Statement">'</span><span class="Constant">-1</span><span class="Type">_</span><span class="Statement">'</span><span class="Identifier">!</span><span class="Delimiter">(</span><span class="Identifier">#</span>a<span class="Delimiter">)</span><span class="Type">#</span><span class="Constant">2</span>             <span class="Comment"> /all patterns except &quot;no stars&quot; and &quot;all stars&quot;</span>
        b<span class="Statement">:</span><span class="Delimiter">(</span><span class="Constant">10</span><span class="Statement">/</span>m<span class="Type">*</span>a<span class="Delimiter">)</span><span class="Type"> +</span><span class="Statement">/:</span><span class="Constant"> 10</span><span class="Statement">/'</span><span class="Delimiter">(</span><span class="Identifier">~</span>m<span class="Delimiter">)</span><span class="Type">*</span><span class="Statement">/:</span><span class="Identifier">!</span><span class="Constant">10</span><span class="Comment"> /numbers to test for primality</span>
        b<span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Identifier">!</span><span class="Constant">-2</span><span class="Type">!</span><span class="Identifier">#*</span>b<span class="Delimiter">]</span><span class="Statement">:</span><span class="Constant">0</span>               <span class="Comment"> /no leading zeroes</span>
        <span class="Identifier">&amp;</span><span class="Statement">/</span>c<span class="Type">@</span><span class="Identifier">&amp;</span>h c<span class="Statement">:</span><span class="Identifier">,</span><span class="Statement">/</span>b<span class="Type">@</span><span class="Statement">\:</span><span class="Identifier">&amp;</span><span class="Constant">7</span><span class="Type">&lt;</span><span class="Identifier">+</span><span class="Statement">/</span>h b<span class="Special">}</span>     <span class="Comment"> /min of the primes from 8+ families</span>
     <span class="Identifier">&amp;</span><span class="Statement">/</span>f<span class="Statement">'</span>p
P<span class="Constant"> 52</span><span class="Special">;</span><span class="Special">{</span><span class="Special">x</span><span class="Type">+</span><span class="Constant">1</span><span class="Type">&lt;</span><span class="Identifier">#?</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">&lt;</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">$</span><span class="Constant">2 3 4 5 6</span><span class="Type">*</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">1</span>
P<span class="Constant"> 53</span><span class="Special">;</span>m<span class="Statement">:</span><span class="Constant">1000001</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span>m<span class="Type">=</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Constant">100</span><span class="Special">{</span>m<span class="Type">&amp;</span><span class="Delimiter">(</span><span class="Constant">0</span><span class="Type">,</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Special">x</span><span class="Type">,</span><span class="Constant">0</span><span class="Special">}</span><span class="Statement">\</span><span class="Constant">1</span>
P<span class="Constant"> 54</span><span class="Special">;</span>p<span class="Statement">:</span><span class="Special">{</span><span class="Special">x</span><span class="Statement">:</span><span class="Delimiter">(</span><span class="Constant">&quot;CDHS&quot;</span><span class="Delimiter">;</span><span class="Constant">&quot;23456789TJQKA&quot;</span><span class="Delimiter">)</span><span class="Type">?</span><span class="Statement">'</span><span class="Identifier">|+</span><span class="Special">x</span>
        s<span class="Statement">:</span><span class="Special">x</span><span class="Constant"> 0</span><span class="Special">;</span>r<span class="Statement">:</span><span class="Special">x</span><span class="Constant"> 1</span>      <span class="Comment"> /s:suits r:ranks</span>
        f<span class="Statement">:</span><span class="Constant">1</span><span class="Type">=</span><span class="Identifier">#?</span>s          <span class="Comment"> /flush?</span>
        g<span class="Statement">:</span><span class="Identifier">~#</span><span class="Delimiter">((</span><span class="Identifier">!</span><span class="Constant">5</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Identifier">&amp;</span><span class="Statement">/</span>r<span class="Delimiter">)</span><span class="Type">^</span>r <span class="Comment"> /straight?</span>
        d<span class="Statement">:</span><span class="Constant">10</span><span class="Statement">/</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">&gt;</span><span class="Special">x</span><span class="Special">}</span><span class="Type">@</span><span class="Identifier">#</span><span class="Statement">'</span><span class="Identifier">=</span>r <span class="Comment"> /rank distribution</span>
        v<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">|</span><span class="Statement">\</span><span class="Delimiter">(</span>f<span class="Type">&amp;</span>g<span class="Delimiter">;</span>d<span class="Type">=</span><span class="Constant">41</span><span class="Delimiter">;</span>d<span class="Type">=</span><span class="Constant">32</span><span class="Delimiter">;</span>f<span class="Delimiter">;</span>g<span class="Delimiter">;</span>d<span class="Type">=</span><span class="Constant">311</span><span class="Delimiter">;</span>d<span class="Type">=</span><span class="Constant">221</span><span class="Delimiter">;</span>d<span class="Type">=</span><span class="Constant">2111</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Comment"> /9=StraightFlush(orRoyal) 8=FourOfAKind etc, 1=HighCard</span>
        h<span class="Statement">:</span>r<span class="Type">@</span><span class="Identifier">&gt;</span>r<span class="Type">+</span><span class="Constant">13</span><span class="Type">*</span><span class="Identifier">+</span><span class="Statement">/</span>r<span class="Type">=</span><span class="Statement">\:</span>r<span class="Comment"> /ranks grouped and ordered by multiplicity</span>
<span class="Constant">        100</span><span class="Statement">/</span>v<span class="Type">,</span>h<span class="Special">}</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Special">{</span><span class="Identifier">&gt;</span><span class="Statement">/</span>p<span class="Statement">'</span><span class="Constant">0 5</span><span class="Type">_</span><span class="Constant">&quot; &quot;</span><span class="Statement">\</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p054_poker.txt&quot;</span>
P<span class="Constant"> 55</span><span class="Special">;</span>lychrel<span class="Statement">:</span><span class="Special">{</span><span class="Special">y</span><span class="Statement">:</span>add<span class="Delimiter">[</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Identifier">|</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">y</span><span class="Type">~</span><span class="Identifier">|</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">o</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Special">}</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">50</span> lychrel<span class="Statement">'</span>big<span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">-1</span><span class="Type">+</span><span class="Constant">10000</span>
P<span class="Constant"> 56</span><span class="Special">;</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Statement">/'</span><span class="Identifier">,</span><span class="Statement">/</span>mul<span class="Statement">'\</span><span class="Constant">99</span><span class="Type">#</span><span class="Identifier">,</span>big<span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">99</span>
P<span class="Constant"> 57</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">&gt;</span><span class="Statement">/'</span><span class="Identifier">#</span><span class="Statement">''</span><span class="Constant">1000</span><span class="Special">{</span>s<span class="Statement">:</span>add<span class="Statement">/</span><span class="Special">x</span><span class="Special">;</span><span class="Delimiter">(</span>add<span class="Delimiter">[</span>s<span class="Delimiter">;</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Delimiter">]</span><span class="Delimiter">;</span>s<span class="Delimiter">)</span><span class="Special">}</span><span class="Statement">\</span>big<span class="Statement">'</span><span class="Constant">1 1</span>
P<span class="Constant"> 58</span><span class="Special">;</span>c<span class="Statement">:</span><span class="Constant">1</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">0</span><span class="Comment"> /c:corner values, n:number of primes on diagonals so far</span>
<span class="Constant">     1</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Special">{</span>c<span class="Type">+:</span><span class="Constant">2 4 6</span><span class="Type">+</span><span class="Constant">8</span><span class="Type">*</span><span class="Special">x</span><span class="Special">;</span>n<span class="Type">+:</span><span class="Identifier">+</span><span class="Statement">/</span>isprime<span class="Statement">'</span>c<span class="Special">;</span><span class="Special">x</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Constant">10</span><span class="Type">*</span>n<span class="Delimiter">)</span><span class="Type">&gt;</span><span class="Constant">4</span><span class="Type">*</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">0</span><span class="Comment"> /x:current layer; side is 1+2*x; number of values on diagonals is 1+4*x</span>
P<span class="Constant"> 59</span><span class="Special">;</span>f<span class="Statement">:</span><span class="Constant">8167 1492 2782 4253 12702 2228 2015 6094 6966 153 772 4025 2406 6749 7507 1929 95 5987 6327 9056 2758 978 2360 150 1974 74</span><span class="Comment"> /a-z freqs</span>
     F<span class="Statement">:</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span><span class="Constant">256</span><span class="Delimiter">;</span><span class="Constant">&quot;aA&quot;</span><span class="Type">+</span><span class="Statement">\:</span><span class="Identifier">!#</span>f<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,</span>f<span class="Delimiter">]</span>         <span class="Comment"> /0x00-0xff freqs</span>
     c<span class="Statement">:</span><span class="Delimiter">(</span><span class="Constant">8</span><span class="Type">#</span><span class="Constant">2</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Constant">&quot;,&quot;</span><span class="Statement">\</span><span class="Identifier">*0:</span><span class="Constant">&quot;i/p059_cipher.txt&quot;</span><span class="Comment"> /ciphertext in binary</span>
     a<span class="Statement">:</span><span class="Special">{</span><span class="Constant">2</span><span class="Statement">/</span><span class="Identifier">~</span>c<span class="Type">=</span><span class="Delimiter">(</span><span class="Identifier">#*</span>c<span class="Delimiter">)</span><span class="Type">#</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Constant">8</span><span class="Type">#</span><span class="Constant">2</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Constant">&quot;a&quot;</span><span class="Type">+</span><span class="Identifier">+!</span><span class="Constant">3</span><span class="Type">#</span><span class="Constant">26</span>  <span class="Comment"> /all possible plaintexts</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Constant">`c</span><span class="Type">$</span>a<span class="Type">@</span><span class="Identifier">&amp;</span><span class="Special">{</span><span class="Special">x</span><span class="Type">=</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Special">x</span><span class="Special">}</span><span class="Type">@</span><span class="Identifier">+</span><span class="Statement">/'</span>F a             <span class="Comment"> /best plaintext by sum-of-freqs score</span>
P<span class="Constant"> 60</span><span class="Special">;</span>k<span class="Statement">:</span><span class="Constant">5</span>
     a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">''</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Identifier">~</span>isprime<span class="Type">@</span><span class="Identifier">.,</span><span class="Statement">/</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span>isprime<span class="Type">@</span><span class="Identifier">.,</span><span class="Statement">/</span><span class="Identifier">|</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Type">#</span>sp<span class="Type">@</span><span class="Identifier">+</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Statement">\:</span><span class="Identifier">&amp;&lt;</span><span class="Statement">/</span><span class="Special">x</span><span class="Special">}</span><span class="Type">@</span><span class="Identifier">!</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">#</span>sp<span class="Statement">:</span><span class="Identifier">$</span><span class="Constant">1</span><span class="Type">_</span>primes<span class="Constant"> 10000</span>
     h<span class="Statement">:</span><span class="Delimiter">(</span>a<span class="Type">@</span><span class="Statement">'</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Type">@</span><span class="Identifier">=*</span><span class="Statement">'</span>a
     <span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Statement">/'</span><span class="Delimiter">(</span>k<span class="Type">-</span><span class="Constant">2</span><span class="Delimiter">)</span><span class="Special">{</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">,</span><span class="Statement">/:'</span><span class="Special">{</span><span class="Special">x</span><span class="Type">^</span><span class="Special">x</span><span class="Type">^</span><span class="Special">y</span><span class="Special">}</span><span class="Statement">/'</span>h <span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span>a
P<span class="Constant"> 61</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Constant">100</span><span class="Type">#</span><span class="Identifier">,!</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Constant">-100</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Identifier">,</span><span class="Delimiter">;</span><span class="Constant">100</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Constant">999</span><span class="Type">&lt;</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Statement">/:</span><span class="Delimiter">(</span><span class="Constant">10000</span><span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Statement">/:</span><span class="Delimiter">(</span><span class="Constant">3</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">6</span><span class="Delimiter">)</span>gon<span class="Statement">\:</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">140</span>
     r<span class="Statement">:</span><span class="Identifier">|*,</span><span class="Statement">/</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">,</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Statement">/:</span><span class="Identifier">&amp;</span><span class="Constant">0</span><span class="Type">|</span><span class="Statement">/'</span><span class="Delimiter">(</span><span class="Identifier">!</span><span class="Constant">100</span><span class="Delimiter">)</span><span class="Type">=</span><span class="Identifier">,</span><span class="Statement">//'</span><span class="Identifier">@</span><span class="Statement">/</span>a<span class="Type">@</span><span class="Constant">5</span><span class="Type">,</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">+</span>prm<span class="Constant"> 5</span>
<span class="Constant">     101</span><span class="Type">*</span><span class="Identifier">+</span><span class="Statement">/</span>r<span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Special">{</span><span class="Identifier">*</span><span class="Special">y</span><span class="Type">@</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">\</span><span class="Identifier">|</span>a<span class="Constant"> 5</span><span class="Type">,</span>r<span class="Constant"> 1</span>
P<span class="Constant"> 62</span><span class="Special">;</span>a<span class="Type">*</span>a<span class="Type">*</span>a<span class="Statement">:</span><span class="Identifier">**</span><span class="Special">{</span><span class="Constant">5</span><span class="Type">=</span><span class="Identifier">#</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span><span class="Identifier">.=</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">&lt;</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Identifier">$</span>a<span class="Type">*</span>a<span class="Type">*</span>a<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">10000</span><span class="Delimiter">)</span><span class="Type">-</span><span class="Constant">&quot;0&quot;</span>
P<span class="Constant"> 63</span><span class="Special">;</span>i<span class="Statement">:</span>big<span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">9</span>
     a<span class="Statement">:</span><span class="Identifier">#</span><span class="Statement">''</span><span class="Constant">30</span><span class="Special">{</span>i mul<span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">\</span><span class="Delimiter">(</span><span class="Identifier">#</span>i<span class="Delimiter">)</span><span class="Type">#</span><span class="Identifier">,</span>big<span class="Constant"> 1</span>
     <span class="Identifier">+</span><span class="Statement">//</span>a<span class="Type">=</span><span class="Identifier">!#</span>a
P<span class="Constant"> 64</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">~</span><span class="Constant">2</span><span class="Type">!</span><span class="Identifier">#</span><span class="Statement">'</span>cfsqrt<span class="Statement">'</span><span class="Identifier">!</span><span class="Constant">10000</span>
P<span class="Constant"> 65</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">100</span>
     c<span class="Statement">:</span>n<span class="Type">#</span><span class="Constant">2</span><span class="Type">,</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Constant">2</span><span class="Type">*</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span>n<span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">)</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Delimiter">(</span>big<span class="Statement">'</span><span class="Constant">0 1</span><span class="Delimiter">)</span><span class="Special">{</span><span class="Delimiter">(</span>add<span class="Delimiter">[</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Delimiter">;</span>mul<span class="Delimiter">[</span><span class="Identifier">*</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]]</span><span class="Delimiter">;</span><span class="Identifier">*</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">|</span>big<span class="Statement">'</span>c
P<span class="Constant"> 66</span><span class="Special">;</span>pell<span class="Statement">:</span><span class="Special">{</span>a0<span class="Statement">:</span><span class="Identifier">_%</span><span class="Special">x</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">=</span>a0<span class="Type">*</span>a0<span class="Delimiter">;</span><span class="Statement">:</span><span class="Identifier">,</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Delimiter">]</span>
           c<span class="Statement">:</span><span class="Constant">-1</span><span class="Type">_</span><span class="Identifier">*|+</span><span class="Delimiter">(</span><span class="Identifier">~</span><span class="Delimiter">(</span><span class="Constant">2</span><span class="Type">*</span>a0<span class="Delimiter">)</span><span class="Type">=</span><span class="Identifier">*|:</span><span class="Delimiter">)(</span><span class="Special">{[N;a0;m;d;a]</span> m<span class="Statement">:</span><span class="Delimiter">(</span>d<span class="Type">*</span>a<span class="Delimiter">)</span><span class="Type">-</span>m<span class="Special">;</span>d<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">-</span>d<span class="Delimiter">)</span><span class="Type">!</span>N<span class="Type">-</span>m<span class="Type">*</span>m<span class="Special">;</span>a<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">-</span>d<span class="Delimiter">)</span><span class="Type">!</span>a0<span class="Type">+</span>m<span class="Special">;</span>m<span class="Type">,</span>d<span class="Type">,</span>a<span class="Special">}</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span>a0<span class="Delimiter">]</span><span class="Type">.</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Constant">0 1</span><span class="Type">,</span>a0<span class="Comment"> /cfrac sqrt</span>
           r<span class="Statement">:</span><span class="Identifier">*|</span><span class="Delimiter">(</span>big<span class="Statement">'</span><span class="Constant">0 1</span><span class="Delimiter">)</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Delimiter">;</span>add<span class="Delimiter">[</span><span class="Identifier">*</span><span class="Special">x</span><span class="Delimiter">;</span>mul<span class="Delimiter">[</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Delimiter">]]</span><span class="Delimiter">)</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">|</span>big<span class="Statement">'</span>c
           <span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">2</span><span class="Type">!</span><span class="Identifier">#</span>c<span class="Delimiter">;</span>add<span class="Delimiter">[</span>big<span class="Constant"> 1</span><span class="Delimiter">;</span>add<span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,</span>mul<span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,</span>r<span class="Delimiter">]</span><span class="Delimiter">;</span>r<span class="Delimiter">]</span><span class="Special">}</span>
     <span class="Identifier">*&amp;</span>a<span class="Type">~</span><span class="Statement">\:</span>max<span class="Statement">/</span>a<span class="Statement">:</span>pell<span class="Statement">'</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">1000</span>
P<span class="Constant"> 67</span><span class="Special">;</span><span class="Identifier">*</span><span class="Special">{</span><span class="Special">y</span><span class="Type">+</span><span class="Constant">1</span><span class="Type">_</span><span class="Identifier">|</span><span class="Statement">':</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">|.</span><span class="Statement">''</span><span class="Constant">&quot; &quot;</span><span class="Statement">\'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p067_triangle.txt&quot;</span>
P<span class="Constant"> 68</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">5</span>
     i<span class="Statement">:</span><span class="Delimiter">(</span><span class="Constant">2</span><span class="Type">*</span>n<span class="Delimiter">)</span><span class="Type">!</span><span class="Constant">0 1 3</span><span class="Type">+</span><span class="Statement">\:</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">!</span>n
     j<span class="Statement">:</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Identifier">+</span>i
     l<span class="Statement">:</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">16</span><span class="Type">#</span><span class="Constant">10</span>
     r<span class="Statement">:</span>prm<span class="Constant"> 2</span><span class="Type">*</span>n
     <span class="Identifier">|</span><span class="Statement">/</span><span class="Delimiter">(</span>l<span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Special">{</span><span class="Identifier">.,</span><span class="Statement">/</span><span class="Identifier">$</span><span class="Special">x</span> j<span class="Special">}</span><span class="Statement">'</span><span class="Special">{</span><span class="Constant">1</span><span class="Type">=</span><span class="Identifier">#?+</span><span class="Statement">/</span><span class="Special">x</span> i<span class="Special">}</span><span class="Type">#</span><span class="Identifier">+</span><span class="Constant">1</span><span class="Type">+</span>r<span class="Type">@</span><span class="Statement">\:</span><span class="Identifier">&amp;&amp;</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">*</span>r<span class="Delimiter">)</span><span class="Type">&lt;</span><span class="Statement">/:</span>r<span class="Type">@</span><span class="Constant">2</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">!</span>n<span class="Type">-</span><span class="Constant">1</span>
P<span class="Constant"> 69</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1000000</span><span class="Special">;</span><span class="Identifier">*&amp;</span>a<span class="Type">=</span><span class="Identifier">|</span><span class="Statement">/</span>a<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">-</span>totients n<span class="Delimiter">)</span><span class="Type">!</span><span class="Statement">'</span><span class="Constant">1000</span><span class="Type">*</span><span class="Identifier">!</span>n
P<span class="Constant"> 70</span><span class="Special">;</span>phi<span class="Statement">:</span>totients<span class="Type">@</span><span class="Identifier">*</span><span class="Statement">/</span>N<span class="Statement">:</span><span class="Constant">7</span><span class="Type">#</span><span class="Constant">10</span>
     t<span class="Statement">:</span><span class="Constant">9</span><span class="Delimiter">(</span><span class="Constant">10</span><span class="Type">*</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Constant">1</span>
     a<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span>t<span class="Type">@</span><span class="Constant">10</span><span class="Statement">\</span>phi
     b<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span>t<span class="Type">@</span><span class="Identifier">!</span>N
     n<span class="Statement">:</span><span class="Constant">2</span><span class="Type">_</span><span class="Identifier">&amp;</span>a<span class="Type">=</span>b
     <span class="Identifier">*</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Identifier">&lt;</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">*</span><span class="Identifier">|</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">/</span>n<span class="Type">,</span><span class="Statement">'</span>phi n<span class="Comment"> /min of rationals</span>
P<span class="Constant"> 71</span><span class="Special">;</span>d<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">1000000</span>
     n<span class="Statement">:</span><span class="Constant">-7</span><span class="Type">!</span><span class="Constant">-1</span><span class="Type">+</span><span class="Constant">3</span><span class="Type">*</span>d
     max<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Type">*</span><span class="Special">y</span><span class="Delimiter">[</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Delimiter">)</span><span class="Type">&gt;</span><span class="Special">x</span><span class="Delimiter">[</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Type">*</span><span class="Special">y</span><span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Comment"> /for rationals</span>
     <span class="Identifier">*</span>max<span class="Statement">/</span><span class="Identifier">+</span><span class="Delimiter">(</span>n<span class="Delimiter">;</span>d<span class="Delimiter">)</span>
P<span class="Constant"> 72</span><span class="Special">;</span><span class="Constant">-1</span><span class="Type">+</span><span class="Statement">/</span>totients<span class="Constant"> 1</span><span class="Type">+</span><span class="Constant">1000000</span>
P<span class="Constant"> 73</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">12000</span>
     p<span class="Statement">:</span>primes n
     t<span class="Statement">:</span><span class="Identifier">~</span><span class="Delimiter">(</span>n<span class="Type">+</span><span class="Constant">1</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Statement">'</span><span class="Identifier">~!</span><span class="Statement">'</span>p
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Special">{</span>a<span class="Statement">:</span><span class="Constant">-3</span><span class="Type">!</span><span class="Special">x</span><span class="Type">+</span><span class="Constant">2</span><span class="Special">;</span>b<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">x</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Statement">/</span>a<span class="Type">_</span><span class="Statement">'</span>b<span class="Type">#</span><span class="Statement">'</span>t<span class="Type">@</span><span class="Identifier">&amp;~</span>p<span class="Type">!</span><span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Constant">4</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">-3</span><span class="Type">+</span>n
P<span class="Constant"> 74</span><span class="Special">;</span>f<span class="Statement">:</span><span class="Identifier">*</span><span class="Statement">\</span><span class="Constant">1</span><span class="Type">|</span><span class="Identifier">!</span><span class="Constant">10</span>
     a<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">|</span><span class="Statement">\</span><span class="Constant">0</span><span class="Type">&lt;</span>d<span class="Delimiter">)</span><span class="Type">*</span>f d<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">3</span><span class="Type">,</span><span class="Constant">6</span><span class="Type">#</span><span class="Constant">10</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">60</span><span class="Type">=</span><span class="Constant">1000000</span><span class="Type">#</span><span class="Special">{</span><span class="Special">x</span><span class="Type">&amp;</span><span class="Constant">61</span><span class="Type">&amp;</span><span class="Constant">1</span><span class="Type">+</span><span class="Special">x</span> a<span class="Special">}</span><span class="Statement">/</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Delimiter">(</span><span class="Identifier">#</span>a<span class="Delimiter">)</span><span class="Type">#</span><span class="Constant">61</span><span class="Delimiter">;</span><span class="Constant">169 363601 1454 871 45361 872 45362</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">3 3 3 2 2 2 2</span><span class="Delimiter">]</span>
P<span class="Constant"> 75</span><span class="Special">;</span>M<span class="Statement">:</span><span class="Constant">1500000</span><span class="Comment"> /max perimeter</span>
     c<span class="Statement">:</span><span class="Identifier">&amp;</span><span class="Constant">1</span><span class="Type">+</span>M   <span class="Comment"> /counters</span>
     <span class="Special">{</span><span class="Special">x</span><span class="Type">@:</span><span class="Identifier">&lt;</span><span class="Special">x</span><span class="Special">;</span>L<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Special">x</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span>L<span class="Type">&gt;</span>M<span class="Delimiter">;</span><span class="Statement">:</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Delimiter">]</span><span class="Special">;</span>c<span class="Delimiter">[</span>L<span class="Type">*</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">-</span>L<span class="Delimiter">)</span><span class="Type">!</span>M<span class="Delimiter">]</span><span class="Type">+:</span><span class="Constant">1</span>
      <span class="Special">o</span><span class="Statement">'</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">((</span><span class="Constant">  1 2 2</span><span class="Delimiter">;</span><span class="Identifier">-</span><span class="Constant"> 1 2 2</span><span class="Delimiter">;</span><span class="Constant">1 2 2</span><span class="Delimiter">)</span>
           <span class="Delimiter">(</span><span class="Identifier">-</span><span class="Constant"> 2 1 2</span><span class="Delimiter">;</span><span class="Constant">  2 1 2</span><span class="Delimiter">;</span><span class="Constant">2 1 2</span><span class="Delimiter">)</span>
           <span class="Delimiter">(</span><span class="Constant">  2 2 3</span><span class="Delimiter">;</span><span class="Constant">  2 2 3</span><span class="Delimiter">;</span><span class="Constant">2 2 3</span><span class="Delimiter">))</span><span class="Type">*</span><span class="Special">x</span><span class="Special">;</span><span class="Special">}</span><span class="Constant">3 4 5</span>
     c<span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Statement">:</span><span class="Constant">0</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">1</span><span class="Type">=</span>c
P<span class="Constant"> 76</span><span class="Special">;</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">*|*|</span><span class="Constant">100</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Constant">-1</span><span class="Type">_</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Identifier">,+</span><span class="Statement">\</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">*</span><span class="Identifier">|=#</span><span class="Special">x</span><span class="Statement">:</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">,</span><span class="Statement">'</span><span class="Identifier">*|+</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Constant">0</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">,,</span><span class="Constant">1</span>
P<span class="Constant"> 77</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">100</span>
     p<span class="Statement">:</span>primes n
     a<span class="Statement">:</span><span class="Identifier">~!</span>n
     <span class="Special">{[p]</span> <span class="Special">{[p;i]</span> a<span class="Delimiter">[</span>i<span class="Type">+</span>p<span class="Delimiter">]</span><span class="Type">+:</span>a<span class="Delimiter">[</span>i<span class="Delimiter">]</span><span class="Special">;</span><span class="Special">}</span><span class="Delimiter">[</span>p<span class="Delimiter">]</span><span class="Statement">'</span><span class="Identifier">!</span><span class="Constant">0</span><span class="Type">|</span>n<span class="Type">-</span>p<span class="Special">;</span><span class="Special">}</span><span class="Statement">'</span>p<span class="Special">;</span>
     <span class="Identifier">*&amp;</span><span class="Constant">5000</span><span class="Type">&lt;</span>a
P<span class="Constant"> 78</span><span class="Comment"> /using the &quot;pentagonal&quot; recurrence relation from</span>
    <span class="Comment"> /<a href="https://en.wikipedia.org/wiki/Partition_function_(number_theory)#Recurrence_relations">https://en.wikipedia.org/wiki/Partition_function_(number_theory)#Recurrence_relations</a></span>
    <span class="Comment"> /p(n) = sum (-1)^(k+1) * p(n-k(3k+1)/2),  -(sqrt(24n+1)-1)/6&lt;=k&lt;=(sqrt(24n+1)+1)/6, k!=0</span>
     p<span class="Statement">:</span><span class="Constant">1 1</span>
     <span class="Special">{</span>r<span class="Statement">:</span><span class="Identifier">_%</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">24</span><span class="Type">*</span><span class="Special">x</span>
      ke<span class="Statement">:</span><span class="Constant">-6</span><span class="Type">!</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">-</span>r<span class="Delimiter">;</span><span class="Constant">1</span><span class="Type">+</span>r<span class="Delimiter">)</span>  <span class="Comment"> /endpoints of k range</span>
      k<span class="Statement">:</span>ke<span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">-</span><span class="Identifier">-</span><span class="Statement">/</span>ke
      s<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">#</span>k<span class="Delimiter">)</span><span class="Type">#</span><span class="Constant">-1 1</span><span class="Type">@</span><span class="Constant">2</span><span class="Type">!</span><span class="Constant">2</span><span class="Type">#</span>k<span class="Comment"> /signs 1 or -1</span>
      p<span class="Type">,:</span>pn<span class="Statement">:</span><span class="Constant">1000000</span><span class="Type">!</span><span class="Identifier">+</span><span class="Statement">/</span>s<span class="Type">*</span><span class="Constant">0</span><span class="Type">|</span>p <span class="Special">x</span><span class="Type">-</span>gon<span class="Delimiter">[</span><span class="Constant">5</span><span class="Delimiter">;</span>k<span class="Delimiter">]</span>
      <span class="Special">x</span><span class="Type">+</span><span class="Constant">0</span><span class="Type">&lt;</span>pn<span class="Special">}</span><span class="Statement">/</span><span class="Constant">2</span>
P<span class="Constant"> 79</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">?.</span><span class="Statement">''</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p079_keylog.txt&quot;</span>
     d<span class="Statement">:</span><span class="Identifier">?,</span><span class="Statement">/</span>a<span class="Comment"> /there are 8 distinct digits in all attempts, so let's try 8-digit codes first</span>
     e<span class="Statement">:</span><span class="Identifier">?,</span><span class="Statement">/</span><span class="Constant">2</span><span class="Statement">''</span>a<span class="Comment"> /edges of a graph</span>
<span class="Constant">     10</span><span class="Statement">/</span><span class="Identifier">|</span><span class="Special">{</span><span class="Identifier">?</span><span class="Special">x</span><span class="Type">,</span>d<span class="Type">@</span><span class="Identifier">&amp;~+</span><span class="Statement">/'</span>d<span class="Type">=</span><span class="Statement">\:</span><span class="Identifier">*</span><span class="Statement">'</span><span class="Special">{</span><span class="Constant">2</span><span class="Type">=</span><span class="Identifier">#</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span>e<span class="Type">^</span><span class="Statement">\:</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">!</span><span class="Constant">0</span><span class="Comment"> /topological sorting, and the code turns out to be only 8 digits</span>
P<span class="Constant"> 80</span><span class="Special">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">=</span>r<span class="Type">*</span>r<span class="Statement">:</span><span class="Identifier">_%</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">100</span><span class="Type">#</span>sqrt<span class="Type">@</span><span class="Delimiter">(</span><span class="Constant">10</span><span class="Statement">\</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Identifier">&amp;</span><span class="Constant">200</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">100</span>
P<span class="Constant"> 81</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">''</span><span class="Constant">&quot;,&quot;</span><span class="Statement">\'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p081_matrix.txt&quot;</span>
     m<span class="Statement">:</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">0W</span>
     <span class="Identifier">*|*|</span><span class="Special">{</span><span class="Special">x</span><span class="Type">&amp;</span>a<span class="Type">+</span><span class="Delimiter">(</span>m<span class="Type">,</span><span class="Statement">'</span><span class="Constant">-1</span><span class="Type">_</span><span class="Statement">'</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">&amp;</span>m<span class="Type">,</span><span class="Constant">-1</span><span class="Type">_</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Statement">\</span><span class="Identifier">+</span><span class="Statement">\'</span>a
P<span class="Constant"> 82</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">''</span><span class="Constant">&quot;,&quot;</span><span class="Statement">\'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p082_matrix.txt&quot;</span>
     m<span class="Statement">:</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">0W</span>
     <span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Identifier">*|+</span><span class="Special">{</span><span class="Special">x</span><span class="Type">&amp;</span>a<span class="Type">+</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">_</span><span class="Special">x</span><span class="Type">,</span>m<span class="Delimiter">)</span><span class="Type">&amp;</span><span class="Delimiter">(</span>m<span class="Type">,</span><span class="Constant">-1</span><span class="Type">_</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">&amp;</span>m<span class="Type">,</span><span class="Statement">'</span><span class="Constant">-1</span><span class="Type">_</span><span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Statement">\'</span>a
P<span class="Constant"> 83</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">''</span><span class="Constant">&quot;,&quot;</span><span class="Statement">\'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p083_matrix.txt&quot;</span>
     m<span class="Statement">:</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">0W</span>
     <span class="Identifier">*|*|</span><span class="Special">{</span><span class="Special">x</span><span class="Type">&amp;</span>a<span class="Type">+</span><span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Delimiter">(</span>m<span class="Type">,</span><span class="Constant">-1</span><span class="Type">_</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Type">_</span><span class="Special">x</span><span class="Type">,</span>m<span class="Delimiter">;</span>m<span class="Type">,</span><span class="Statement">'</span><span class="Constant">-1</span><span class="Type">_</span><span class="Statement">'</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Type">_</span><span class="Statement">'</span><span class="Special">x</span><span class="Type">,</span><span class="Statement">'</span>m<span class="Delimiter">)</span><span class="Special">}</span><span class="Statement">/</span><span class="Identifier">+</span><span class="Statement">\</span><span class="Identifier">+</span><span class="Statement">\'</span>a
P<span class="Constant"> 84</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">200000</span><span class="Comment"> /number of moves to simulate</span>
     jmps<span class="Statement">:</span><span class="Constant">0 10 11 24 39 5</span><span class="Comment"> /GO,JAIL,C1,E3,H2,R1</span>
     c<span class="Statement">:</span><span class="Identifier">&amp;</span><span class="Constant">40</span><span class="Special">;</span>p<span class="Statement">:</span><span class="Constant">0</span><span class="Special">;</span>m<span class="Statement">:</span><span class="Constant">0</span><span class="Comment"> /c:counters, p:position, m:consecutive doubles</span>
     f<span class="Statement">:</span><span class="Special">{</span>c<span class="Delimiter">[</span>p<span class="Delimiter">]</span><span class="Type">+:</span><span class="Constant">1</span><span class="Special">;</span>d<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">?</span><span class="Constant">4</span><span class="Special">;</span>m<span class="Type">+:</span><span class="Constant">1</span><span class="Special">;</span>m<span class="Type">*:</span><span class="Identifier">=</span><span class="Statement">/</span>d<span class="Special">;</span>p<span class="Statement">::</span><span class="Delimiter">(</span><span class="Identifier">#</span>c<span class="Delimiter">)</span><span class="Type">!</span>p<span class="Type">+</span><span class="Statement">/</span>d
        <span class="Identifier">$</span><span class="Delimiter">[</span><span class="Delimiter">(</span>p<span class="Type">=</span><span class="Constant">30</span><span class="Delimiter">)</span><span class="Type">|</span>m<span class="Type">&gt;</span><span class="Constant">2</span><span class="Delimiter">;</span>p<span class="Statement">::</span><span class="Constant">10</span>                   <span class="Comment"> /if on G2J, or got 3 consecutive doubles, go to JAIL</span>
          <span class="Identifier">~^</span><span class="Constant">2 17 33</span><span class="Type">?</span>p<span class="Delimiter">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">2</span><span class="Type">&gt;</span>r<span class="Statement">:</span><span class="Identifier">*</span><span class="Constant">1</span><span class="Type">?</span><span class="Constant">16</span><span class="Delimiter">;</span>p<span class="Statement">::</span>jmps r<span class="Delimiter">;</span><span class="Delimiter">]</span><span class="Comment"> /if on CC1 or CC2 or CC3, possibly go to GO or JAIL</span>
          <span class="Identifier">~^</span>i<span class="Statement">:</span><span class="Constant">7 22 36</span><span class="Type">?</span>p                      <span class="Comment"> /if on CH1 or CH2 or CH3, go ...</span>
          p<span class="Statement">::</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">6</span><span class="Type">&gt;</span>r<span class="Statement">:</span><span class="Identifier">*</span><span class="Constant">1</span><span class="Type">?</span><span class="Constant">16</span><span class="Delimiter">;</span>jmps r              <span class="Comment"> / to the corresponding square from jmps</span>
<span class="Constant">               8</span><span class="Type">&gt;</span>r<span class="Delimiter">;</span><span class="Constant">15 25 5</span><span class="Type"> @</span>i                <span class="Comment"> / to next R (railway company) - R1 or R2 or R3</span>
<span class="Constant">               8</span><span class="Type">=</span>r<span class="Delimiter">;</span><span class="Constant">12 28 12</span><span class="Type">@</span>i                <span class="Comment"> / to next U (utility company) - U1 or U2 or U1(again)</span>
<span class="Constant">               9</span><span class="Type">=</span>r<span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Identifier">#</span>c<span class="Delimiter">)</span><span class="Type">!</span>p<span class="Type">-</span><span class="Constant">3</span>                  <span class="Comment"> / back 3 squares</span>
               p<span class="Delimiter">]]</span><span class="Special">;</span><span class="Special">}</span>
     n f<span class="Statement">/</span><span class="Constant">0</span><span class="Special">;</span>
<span class="Constant">     100</span><span class="Statement">/</span><span class="Constant">3</span><span class="Type">#</span><span class="Identifier">&gt;</span>c
P<span class="Constant"> 85</span><span class="Special">;</span>i<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">2000</span>
     t<span class="Statement">:</span><span class="Constant">-2</span><span class="Type">!</span>i<span class="Type">*</span><span class="Constant">1</span><span class="Type">+</span>i
     a<span class="Type">|:</span><span class="Identifier">-</span>a<span class="Statement">:</span><span class="Constant">2000000</span><span class="Type">-</span>t<span class="Type">*</span><span class="Statement">\:</span>t
     <span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Identifier">&amp;</span><span class="Statement">'</span>a<span class="Type">=</span><span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Identifier">&amp;</span><span class="Statement">/</span>a
P<span class="Constant"> 86</span><span class="Special">;</span>l<span class="Statement">:</span><span class="Constant">2</span><span class="Special">;</span>c<span class="Statement">:</span><span class="Constant">0</span><span class="Comment"> /c:counter</span>
     <span class="Special">{</span>c<span class="Type">&lt;</span><span class="Constant">1000000</span><span class="Special">}{</span>l<span class="Type">+:</span><span class="Constant">1</span><span class="Special">;</span><span class="Special">{</span>r<span class="Statement">:</span><span class="Identifier">_%</span>a<span class="Statement">:</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">*</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">+</span>l<span class="Type">*</span>l<span class="Special">;</span>c<span class="Type">+:</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Identifier">~</span>a<span class="Type">=</span>r<span class="Type">*</span>r<span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Type">&gt;</span>l<span class="Delimiter">;</span><span class="Constant">1</span><span class="Type">+</span>l<span class="Type">-</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Constant">-2</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">;</span><span class="Special">}</span><span class="Statement">'</span><span class="Constant">3</span><span class="Type">_</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span>l<span class="Special">}</span><span class="Statement">/</span><span class="Constant">0</span><span class="Special">;</span>
     l
P<span class="Constant"> 87</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">50000000</span>
     p<span class="Statement">:</span>primes<span class="Constant"> 1</span><span class="Type">+</span><span class="Identifier">_%</span>n
     a<span class="Statement">:</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span>p<span class="Type">*</span>p
     b<span class="Statement">:</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span>a<span class="Type">*</span><span class="Delimiter">(</span><span class="Identifier">#</span>a<span class="Delimiter">)</span><span class="Type">#</span>p
     c<span class="Statement">:</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span>b<span class="Type">*</span><span class="Delimiter">(</span><span class="Identifier">#</span>b<span class="Delimiter">)</span><span class="Type">#</span>p
     bc<span class="Statement">:</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Identifier">,</span><span class="Statement">/</span>b<span class="Type">+</span><span class="Statement">\:</span>c
     s<span class="Statement">:</span><span class="Delimiter">(</span>n<span class="Type">&gt;</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Identifier">,</span><span class="Statement">/</span>a<span class="Type">+</span><span class="Statement">/:</span>bc
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">&amp;</span>n<span class="Delimiter">;</span>s<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span>
P<span class="Constant"> 88</span><span class="Special">;</span>L<span class="Statement">:</span><span class="Constant">12000</span>
     a<span class="Statement">:</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">{</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">,</span><span class="Statement">/:'</span><span class="Delimiter">(</span><span class="Identifier">*</span><span class="Statement">'</span><span class="Identifier">|</span><span class="Statement">'</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">_</span><span class="Statement">'</span><span class="Identifier">!</span><span class="Statement">'</span><span class="Constant">1</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">-*</span><span class="Statement">/'</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">!</span><span class="Statement">'</span><span class="Constant">2</span><span class="Type">*</span>L<span class="Special">}</span><span class="Statement">\</span><span class="Identifier">,</span><span class="Statement">'</span><span class="Constant">2</span><span class="Type">_</span><span class="Identifier">!</span><span class="Constant">2</span><span class="Type">*</span>L<span class="Comment"> /all factorisations up to 2L</span>
     k<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">-</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span>a
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">?</span><span class="Constant">2</span><span class="Type">_</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Constant">0</span><span class="Type">,</span>L<span class="Type">#</span><span class="Constant">0W</span><span class="Delimiter">;</span>k<span class="Type">*</span>k<span class="Type">&lt;</span>L<span class="Type">+</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Identifier">&amp;</span><span class="Delimiter">;</span><span class="Identifier">*</span><span class="Statement">/'</span>a<span class="Delimiter">]</span>
P<span class="Constant"> 89</span><span class="Special">;</span>r<span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">,</span><span class="Delimiter">(</span><span class="Identifier">!</span><span class="Constant">10</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Statement">'</span><span class="Constant">&quot;M&quot;</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Delimiter">(</span><span class="Constant">&quot;CDM&quot;</span><span class="Delimiter">;</span><span class="Constant">&quot;XLC&quot;</span><span class="Delimiter">;</span><span class="Constant">&quot;IVX&quot;</span><span class="Delimiter">)</span><span class="Type">@</span><span class="Statement">\:</span><span class="Delimiter">(</span><span class="Identifier">!</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Constant">0 0</span><span class="Delimiter">;</span><span class="Constant">0 0 0</span><span class="Delimiter">;</span><span class="Constant">0 1</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Constant">1 0</span><span class="Delimiter">;</span><span class="Constant">1 0 0</span><span class="Delimiter">;</span><span class="Constant">1 0 0 0</span><span class="Delimiter">;</span><span class="Constant">0 2</span><span class="Delimiter">)</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">-</span><span class="Identifier">#,</span><span class="Statement">/</span>r<span class="Type">@</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Constant">4</span><span class="Type">#</span><span class="Constant">10</span><span class="Delimiter">)</span><span class="Statement">\</span><span class="Identifier">+</span><span class="Statement">/</span>a<span class="Type">*</span><span class="Constant">1</span><span class="Type">-</span><span class="Constant">2</span><span class="Type">*</span><span class="Identifier">&lt;</span><span class="Statement">':</span>a<span class="Statement">:</span><span class="Constant">1 5 10 50 100 500 1000</span><span class="Constant">&quot;IVXLCDM&quot;</span><span class="Type">?</span><span class="Identifier">|</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p089_roman.txt&quot;</span>
P<span class="Constant"> 90</span><span class="Special">;</span>r69<span class="Statement">:</span><span class="Special">{</span><span class="Special">x</span><span class="Type">+</span><span class="Constant">3</span><span class="Type">*</span><span class="Special">x</span><span class="Type">=</span><span class="Constant">6</span><span class="Special">}</span>
     sq<span class="Statement">:</span><span class="Identifier">+</span>r69<span class="Type">@</span><span class="Constant">10</span><span class="Statement">\</span><span class="Special">{</span><span class="Special">x</span><span class="Type">*</span><span class="Special">x</span><span class="Special">}</span><span class="Type">@</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">9</span>
     c<span class="Statement">:</span><span class="Identifier">+</span>r69<span class="Type">@</span>cmb<span class="Delimiter">[</span><span class="Constant">6</span><span class="Delimiter">;</span><span class="Constant">10</span><span class="Delimiter">]</span>
     c2<span class="Statement">:</span><span class="Identifier">+</span>c<span class="Type">@</span>cmb<span class="Delimiter">[</span><span class="Constant">2</span><span class="Delimiter">;</span><span class="Identifier">#</span>c<span class="Delimiter">]</span>
     <span class="Identifier">#</span>c2<span class="Type">@</span><span class="Identifier">&amp;</span><span class="Special">{</span><span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">&amp;</span><span class="Statement">/'</span><span class="Identifier">|</span><span class="Statement">/''</span>sq<span class="Type">=</span><span class="Statement">\:</span> <span class="Special">x</span>
                <span class="Identifier">&amp;</span><span class="Statement">/'</span><span class="Identifier">|</span><span class="Statement">/''</span>sq<span class="Type">=</span><span class="Statement">\:</span><span class="Identifier">|</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Special">}</span><span class="Statement">'</span>c2
P<span class="Constant"> 91</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">50</span>
     pq<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">4</span><span class="Type">#</span>n
     p<span class="Statement">:</span><span class="Constant">2</span><span class="Type">#</span>pq
     q<span class="Statement">:</span><span class="Constant">2</span><span class="Type">_</span>pq
     a2<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,</span>p
     b2<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,</span>p<span class="Type">-</span>q
     c2<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span><span class="Identifier">,</span>q
     r<span class="Statement">:</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span>c2<span class="Type">=</span>a2<span class="Type">+</span>b2<span class="Delimiter">)</span><span class="Type">&amp;</span><span class="Statement">/</span><span class="Delimiter">(</span>a2<span class="Delimiter">;</span>b2<span class="Delimiter">;</span>c2<span class="Delimiter">)</span><span class="Type">&gt;</span><span class="Constant">0</span><span class="Comment"> /right angle at p</span>
     r<span class="Type">+</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">2</span><span class="Type">#</span>n<span class="Type">-</span><span class="Constant">1</span>                   <span class="Comment"> /right angle at origin</span>
P<span class="Constant"> 92</span><span class="Special">;</span>m<span class="Statement">:</span><span class="Constant">1000</span>
     u<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Type">&lt;</span><span class="Constant">2</span><span class="Delimiter">;</span><span class="Constant">0</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Type">=</span><span class="Constant">89</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Special">o</span><span class="Type">@</span><span class="Identifier">+</span><span class="Statement">/</span>a<span class="Type">*</span>a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Identifier">$</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">'</span><span class="Identifier">!</span>m
     p<span class="Statement">:</span><span class="Identifier">&amp;</span><span class="Statement">'</span>q<span class="Type">*</span>q<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">10</span>
     <span class="Identifier">+</span><span class="Statement">/</span>u<span class="Type">*</span><span class="Constant">7</span><span class="Special">{</span><span class="Identifier">+</span><span class="Statement">/</span>m<span class="Type">#</span><span class="Statement">'</span>p<span class="Type">,</span><span class="Statement">\:</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">1</span><span class="Type">,</span><span class="Identifier">&amp;</span>m<span class="Type">-</span><span class="Constant">1</span>
P<span class="Constant"> 93</span><span class="Special">;</span>R<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">1</span><span class="Type">&lt;</span><span class="Identifier">*|</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Delimiter">(</span><span class="Identifier">-</span>gcd<span class="Statement">/</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">!</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Comment"> /rational</span>
     ops<span class="Statement">:</span><span class="Delimiter">(</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">*</span><span class="Identifier">|</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Identifier">*|</span><span class="Special">x</span><span class="Type">*</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Special">}</span>    <span class="Comment"> /+</span>
          <span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">-</span><span class="Statement">/</span><span class="Special">x</span><span class="Type">*</span><span class="Identifier">|</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Identifier">*|</span><span class="Special">x</span><span class="Type">*</span><span class="Special">y</span><span class="Delimiter">)</span><span class="Special">}</span>    <span class="Comment"> /-</span>
          <span class="Identifier">*</span>                   <span class="Comment"> /*</span>
          <span class="Special">{</span><span class="Special">x</span><span class="Type">*</span><span class="Identifier">|$</span><span class="Delimiter">[</span><span class="Constant">0</span><span class="Type">&gt;</span><span class="Identifier">*</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Identifier">-</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Delimiter">)</span>  <span class="Comment"> /div</span>
     bkt<span class="Statement">:</span><span class="Special">{</span>a<span class="Statement">:</span><span class="Special">x</span><span class="Constant"> 0</span><span class="Special">;</span>b<span class="Statement">:</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Special">;</span>c<span class="Statement">:</span><span class="Special">x</span><span class="Constant"> 2</span><span class="Special">;</span>d<span class="Statement">:</span><span class="Special">x</span><span class="Constant"> 3</span><span class="Special">;</span>f<span class="Statement">:</span><span class="Special">y</span><span class="Constant"> 0</span><span class="Special">;</span>g<span class="Statement">:</span><span class="Special">y</span><span class="Constant"> 1</span><span class="Special">;</span>h<span class="Statement">:</span><span class="Special">y</span><span class="Constant"> 2</span><span class="Comment"> /all bracket placements over 4 values x and 3 functions y</span>
          fab<span class="Statement">:</span>f<span class="Delimiter">[</span>a<span class="Delimiter">;</span>b<span class="Delimiter">]</span><span class="Special">;</span>fbc<span class="Statement">:</span>f<span class="Delimiter">[</span>b<span class="Delimiter">;</span>c<span class="Delimiter">]</span>
          R<span class="Statement">'</span><span class="Delimiter">(</span>h<span class="Delimiter">[</span>g<span class="Delimiter">[</span>fab<span class="Delimiter">;</span>c<span class="Delimiter">]</span><span class="Delimiter">;</span>d<span class="Delimiter">]</span>
             h<span class="Delimiter">[</span>g<span class="Delimiter">[</span>a<span class="Delimiter">;</span>fbc<span class="Delimiter">]</span><span class="Delimiter">;</span>d<span class="Delimiter">]</span>
             h<span class="Delimiter">[</span>fab<span class="Delimiter">;</span>g<span class="Delimiter">[</span>c<span class="Delimiter">;</span>d<span class="Delimiter">]]</span>
             h<span class="Delimiter">[</span>a<span class="Delimiter">;</span>g<span class="Delimiter">[</span>fbc<span class="Delimiter">;</span>d<span class="Delimiter">]]</span>
             h<span class="Delimiter">[</span>a<span class="Delimiter">;</span>g<span class="Delimiter">[</span>b<span class="Delimiter">;</span>f<span class="Delimiter">[</span>c<span class="Delimiter">;</span>d<span class="Delimiter">]]]</span><span class="Delimiter">)</span><span class="Special">}</span>
     howfar<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Identifier">&amp;</span><span class="Statement">\</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Identifier">~!</span><span class="Constant">100</span><span class="Delimiter">;</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Constant">99</span><span class="Type">&amp;</span><span class="Constant">0</span><span class="Type">|</span><span class="Identifier">*</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">*</span><span class="Special">x</span><span class="Delimiter">[</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Type">=</span><span class="Constant">1</span><span class="Special">}</span><span class="Type">@</span><span class="Identifier">+,</span><span class="Statement">/</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">+</span>prm<span class="Constant"> 4</span><span class="Delimiter">)</span>bkt<span class="Statement">/:\:</span>ops<span class="Type">@</span><span class="Identifier">+!</span><span class="Constant">3</span><span class="Type">#</span><span class="Identifier">#</span>ops<span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Special">}</span>
<span class="Constant">     10</span><span class="Statement">/</span><span class="Identifier">*</span>c<span class="Type">@</span><span class="Identifier">&amp;</span>v<span class="Type">=</span><span class="Identifier">|</span><span class="Statement">/</span>v<span class="Statement">:</span>howfar<span class="Statement">'</span><span class="Delimiter">((</span><span class="Identifier">!</span><span class="Constant">10</span><span class="Delimiter">)</span><span class="Type">,</span><span class="Statement">'</span><span class="Constant">1</span><span class="Delimiter">)</span>c<span class="Statement">:</span><span class="Identifier">+</span>cmb<span class="Delimiter">[</span><span class="Constant">4</span><span class="Delimiter">;</span><span class="Constant">10</span><span class="Delimiter">]</span>
P<span class="Constant"> 94</span><span class="Comment"> /sides: (a+d;a;a) where d=1 or d=-1</span>
    <span class="Comment"> /p=(3a+d)/2, S^2=p(p-a+d)(p-a)^2, a=2b+1</span>
    <span class="Comment"> /S^2=(3b+2)b(b+1)^2  or  S^2=(3b+1)b^2(b+1)</span>
    <span class="Comment"> /(3b+1)^2-3m^2=1     or  (3b+2)^2-3m^2=1, solve as pell equations</span>
     l<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">-2</span><span class="Type">!</span><span class="Identifier">*</span><span class="Statement">/</span><span class="Constant">9</span><span class="Type">#</span><span class="Constant">10</span>
     s<span class="Statement">:</span><span class="Constant">0</span>
     <span class="Special">{</span>l<span class="Type">&gt;</span><span class="Identifier">*</span><span class="Special">x</span><span class="Special">}{</span><span class="Special">x</span><span class="Statement">:</span><span class="Delimiter">(</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">2 3</span><span class="Type">*</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">1 2</span><span class="Type">*</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Constant">1</span><span class="Type">+</span><span class="Constant">2</span><span class="Type">*</span><span class="Constant">-3</span><span class="Type">!</span><span class="Identifier">*</span><span class="Special">x</span><span class="Special">;</span>P<span class="Statement">:</span><span class="Delimiter">(</span><span class="Constant">3</span><span class="Type">*</span>a<span class="Delimiter">)</span><span class="Type">+</span><span class="Constant">0N -1 1</span><span class="Type">@</span><span class="Constant">3</span><span class="Type">!</span><span class="Identifier">*</span><span class="Special">x</span><span class="Special">;</span>s<span class="Type">+:</span>P<span class="Type">*</span>P<span class="Type">&lt;</span>l<span class="Special">;</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">2 1</span><span class="Special">;</span>
     s
P<span class="Constant"> 95</span><span class="Special">;</span>n<span class="Statement">:</span><span class="Constant">1000000</span>
     a<span class="Statement">:</span>sigma1<span class="Delimiter">[</span>n<span class="Delimiter">]</span><span class="Type">-</span><span class="Identifier">!</span>n
     A<span class="Statement">:</span><span class="Delimiter">(</span>a<span class="Delimiter">;</span>a a<span class="Delimiter">)</span>
     <span class="Identifier">&amp;</span><span class="Statement">/</span><span class="Identifier">,</span><span class="Statement">/</span>c<span class="Type">@</span><span class="Identifier">&amp;</span>l<span class="Type">=</span><span class="Identifier">|</span><span class="Statement">/</span>l<span class="Statement">:</span><span class="Identifier">#</span><span class="Statement">'</span>c<span class="Statement">:</span><span class="Delimiter">(</span>a<span class="Type">@</span><span class="Delimiter">)</span><span class="Statement">\'</span><span class="Identifier">?*</span><span class="Delimiter">(</span><span class="Identifier">~~</span><span class="Statement">/</span><span class="Delimiter">)</span><span class="Special">{</span>A<span class="Type">@</span><span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span>A
P<span class="Constant"> 96</span><span class="Special">;</span>a<span class="Statement">:</span><span class="Identifier">.</span><span class="Statement">''</span><span class="Identifier">,</span><span class="Statement">/'</span><span class="Constant">1</span><span class="Type">_</span><span class="Statement">'</span><span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">&quot;</span><span class="Statement">\'</span><span class="Constant">1</span><span class="Type">_</span><span class="Constant">&quot;G&quot;</span><span class="Statement">\</span><span class="Identifier">1:</span><span class="Constant">&quot;i/p096_sudoku.txt&quot;</span>
     p<span class="Type">,:</span><span class="Identifier">,</span><span class="Constant">3</span><span class="Statement">/</span><span class="Constant">-3</span><span class="Type">!</span>p<span class="Statement">:</span><span class="Identifier">!</span><span class="Constant">9 9</span>
     s<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">*</span><span class="Delimiter">(</span><span class="Identifier">,</span><span class="Special">x</span><span class="Delimiter">)(</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">{</span><span class="Identifier">@</span><span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">;</span><span class="Statement">:</span><span class="Delimiter">;</span><span class="Delimiter">]</span><span class="Statement">'</span><span class="Delimiter">(</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">!</span><span class="Constant">9</span><span class="Delimiter">)</span><span class="Type">^</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">&amp;|</span><span class="Statement">/</span>p<span class="Type">=</span>p<span class="Type">@</span><span class="Statement">'</span><span class="Special">y</span><span class="Special">}</span><span class="Statement">'</span><span class="Delimiter">)</span><span class="Statement">/</span><span class="Identifier">&amp;~</span><span class="Special">x</span><span class="Special">}</span>
     <span class="Identifier">+</span><span class="Statement">/</span><span class="Constant">10</span><span class="Statement">/'</span><span class="Constant">3</span><span class="Type">#</span><span class="Statement">'</span>s<span class="Statement">'</span>a
P<span class="Constant"> 97</span><span class="Special">;</span>mod<span class="Statement">:</span><span class="Special">{</span><span class="Delimiter">(</span><span class="Identifier">-</span><span class="Constant"> 10</span><span class="Type">&amp;</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">#</span><span class="Special">x</span><span class="Special">}</span>
     sqr<span class="Statement">:</span><span class="Special">{</span>mod mul<span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span>
     prd<span class="Statement">:</span><span class="Special">{</span>mod mul<span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">/</span>
     pow<span class="Statement">:</span><span class="Special">{</span>prd<span class="Type">@</span><span class="Delimiter">((</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">#</span>e<span class="Delimiter">)</span>sqr<span class="Statement">\</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">@</span><span class="Identifier">&amp;</span>e<span class="Statement">:</span><span class="Identifier">|</span><span class="Constant">2</span><span class="Statement">\</span><span class="Special">y</span><span class="Special">}</span>
     small mod add<span class="Delimiter">[</span>big<span class="Constant"> 1</span><span class="Delimiter">;</span>mul<span class="Delimiter">[</span>big<span class="Constant"> 28433</span><span class="Delimiter">;</span>pow<span class="Delimiter">[</span>big<span class="Constant"> 2</span><span class="Delimiter">;</span><span class="Constant">7830457</span><span class="Delimiter">]]]</span><span class="Comment"> /28433*(2^7830457)+1 mod 10^10</span>
P<span class="Constant"> 98</span><span class="Special">;</span>pairs<span class="Statement">:</span><span class="Special">{</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">+</span>c<span class="Type">,</span><span class="Statement">'</span><span class="Identifier">|</span>c<span class="Statement">:</span>cmb<span class="Delimiter">[</span><span class="Constant">2</span><span class="Delimiter">;</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">'</span><span class="Special">{</span><span class="Constant">1</span><span class="Type">&lt;</span><span class="Identifier">#</span><span class="Special">x</span><span class="Special">}</span><span class="Type">#</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">.=</span><span class="Special">{</span><span class="Special">x</span><span class="Type">@</span><span class="Identifier">&lt;</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">'</span><span class="Special">x</span><span class="Special">}</span>
     a<span class="Statement">:</span>pairs<span class="Type">@</span><span class="Constant">1</span><span class="Type">_</span><span class="Statement">'</span><span class="Constant">-1</span><span class="Type">_</span><span class="Statement">'</span><span class="Constant">&quot;,&quot;</span><span class="Statement">\</span><span class="Identifier">1:</span><span class="Constant">&quot;i/p098_words.txt&quot;</span>
     m<span class="Statement">:</span><span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">#</span><span class="Statement">'</span><span class="Identifier">*</span><span class="Statement">'</span>a<span class="Comment"> /max length</span>
     b<span class="Statement">:</span>pairs<span class="Type">@</span><span class="Identifier">$</span><span class="Special">{</span><span class="Special">x</span><span class="Type">*</span><span class="Special">x</span><span class="Special">}</span><span class="Type">@</span><span class="Identifier">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">_%*</span><span class="Statement">/</span>m<span class="Type">#</span><span class="Constant">10</span>
     enc<span class="Statement">:</span><span class="Special">{</span>m<span class="Statement">/</span><span class="Identifier">,</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Identifier">*</span><span class="Special">x</span><span class="Delimiter">)</span><span class="Type">?</span><span class="Statement">/:</span><span class="Special">x</span><span class="Special">}</span>
     <span class="Identifier">|</span><span class="Statement">/</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Identifier">,</span><span class="Statement">/</span>b<span class="Type">@</span><span class="Identifier">&amp;~^</span><span class="Delimiter">(</span><span class="Identifier">?</span>enc<span class="Statement">'</span>a<span class="Delimiter">)</span><span class="Type">?</span>enc<span class="Statement">'</span>b
P<span class="Constant"> 99</span><span class="Special">;</span>d<span class="Statement">:</span><span class="Constant">10</span><span class="Comment"> /digits of precision</span>
     fp<span class="Statement">:</span><span class="Special">{</span><span class="Special">x</span><span class="Statement">:</span>big <span class="Special">x</span><span class="Special">;</span><span class="Delimiter">(</span><span class="Identifier">#</span><span class="Special">x</span><span class="Delimiter">;</span>d<span class="Type">#</span><span class="Special">x</span><span class="Type">,</span><span class="Identifier">&amp;</span>d<span class="Delimiter">)</span><span class="Special">}</span>
     fmul<span class="Statement">:</span><span class="Special">{</span>r<span class="Statement">:</span>mul<span class="Delimiter">[</span><span class="Special">x</span><span class="Constant"> 1</span><span class="Delimiter">;</span><span class="Special">y</span><span class="Constant"> 1</span><span class="Delimiter">]</span><span class="Special">;</span><span class="Identifier">$</span><span class="Delimiter">[</span><span class="Constant">4</span><span class="Type">&lt;</span>r d<span class="Delimiter">;</span>r<span class="Statement">:</span>carry<span class="Type">@</span><span class="Identifier">@</span><span class="Delimiter">[</span>r<span class="Delimiter">;</span>d<span class="Type">-</span><span class="Constant">1</span><span class="Delimiter">;</span><span class="Identifier">+</span><span class="Delimiter">;</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Delimiter">;</span><span class="Delimiter">]</span><span class="Special">;</span><span class="Delimiter">(</span><span class="Special">x</span><span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Type">+</span><span class="Special">y</span><span class="Delimiter">[</span><span class="Constant">0</span><span class="Delimiter">]</span><span class="Type">+</span><span class="Delimiter">(</span><span class="Identifier">#</span>r<span class="Delimiter">)</span><span class="Type">-</span><span class="Constant">2</span><span class="Type">*</span>d<span class="Delimiter">;</span>d<span class="Type">#</span>r<span class="Delimiter">)</span><span class="Special">}</span>
     fpow<span class="Statement">:</span><span class="Special">{</span>fmul<span class="Statement">/</span><span class="Delimiter">((</span><span class="Constant">-1</span><span class="Type">+</span><span class="Identifier">#</span>e<span class="Delimiter">)</span><span class="Special">{</span>fmul<span class="Delimiter">[</span><span class="Special">x</span><span class="Delimiter">;</span><span class="Special">x</span><span class="Delimiter">]</span><span class="Special">}</span><span class="Statement">\</span>fp <span class="Special">x</span><span class="Delimiter">)</span><span class="Type">@</span><span class="Identifier">&amp;</span>e<span class="Statement">:</span><span class="Identifier">|</span><span class="Constant">2</span><span class="Statement">\</span><span class="Special">y</span><span class="Special">}</span>
<span class="Constant">     1</span><span class="Type">+</span><span class="Identifier">*&amp;</span>r<span class="Type">~</span><span class="Statement">\:</span>r<span class="Type">@</span><span class="Identifier">*&gt;</span>r<span class="Statement">:</span>fpow<span class="Statement">/'</span><span class="Identifier">.</span><span class="Statement">'</span><span class="Identifier">0:</span><span class="Constant">&quot;i/p099_base_exp.txt&quot;</span>
P<span class="Constant"> 100</span><span class="Comment"> /k(k-1)/n(n-1)=1/2, x=2n-1, y=2k-1, x^2-2v^2=-1</span>
     r<span class="Statement">:</span><span class="Special">{</span><span class="Constant">1000000000001</span><span class="Type">&gt;</span><span class="Constant">-2</span><span class="Type">!</span><span class="Constant">1</span><span class="Type">+</span><span class="Identifier">*</span><span class="Special">x</span><span class="Special">}{</span><span class="Constant">2</span><span class="Delimiter">(</span><span class="Identifier">+</span><span class="Statement">/</span><span class="Delimiter">(</span><span class="Constant">1 1</span><span class="Delimiter">;</span><span class="Constant">2 1</span><span class="Delimiter">)</span><span class="Type">*</span><span class="Delimiter">)</span><span class="Statement">/</span><span class="Special">x</span><span class="Special">}</span><span class="Statement">/</span><span class="Constant">1 1</span><span class="Comment"> /start with x=y=1; while n&lt;=10^12, produce a new solution twice</span>
<span class="Constant">     -2</span><span class="Type">!</span><span class="Constant">1</span><span class="Type">+</span>r<span class="Delimiter">[</span><span class="Constant">1</span><span class="Delimiter">]</span><span class="Comment"> /k</span>
</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->
